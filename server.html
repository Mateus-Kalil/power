<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Server MK</title>
    
    <link rel="icon" href="w.png" type="image/x-icon" />
    <link rel="shortcut icon" href="w.png" type="image/x-icon" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            overflow: hidden;
            user-select: none;
        }
        
        #desktop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100vh - 40px);
            background-image: url('d.jpg');
            background-size: cover;
            background-position: center;
            overflow: hidden;
        }
        
        #taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            background-color: #0d0d0d;
            display: flex;
            align-items: center;
            z-index: 1000;
        }
        
        #start-button {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        #start-button:hover {
            background-color: #333;
        }
        
        #start-button img {
            filter: brightness(0) invert(1);
            width: 20px;
            height: 20px;
        }
        
        #search-container {
            width: 200px;
            height: 30px;
            margin-left: 5px;
            background-color: #222;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding: 0 10px;
        }
        
        #search-box {
            width: 100%;
            background-color: transparent;
            border: none;
            color: white;
            font-size: 13px;
            outline: none;
        }
        
        #search-box::placeholder {
            color: #aaa;
        }
        
        #start-menu {
            position: absolute;
            bottom: 40px;
            left: 0;
            width: 400px;
            height: 600px;
            background-color: #0d0d0d;
            border: 1px solid #333;
            display: none;
            z-index: 1001;
            color: white;
            flex-direction: column;
        }
        
        .start-menu-header {
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            border-bottom: 1px solid #333;
        }
        
        .start-menu-apps {
            display: flex;
            flex-wrap: wrap;
            padding: 10px;
            overflow-y: auto;
            flex-grow: 1;
        }
        
        .app-icon {
            width: 90px;
            height: 90px;
            margin: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            text-align: center;
            padding: 5px;
            transition: background-color 0.2s;
        }
        
        .app-icon:hover {
            background-color: #333;
        }
        
        .app-icon img {
            
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }
        
        .app-icon span {
            font-size: 12px;
        }
        
        .taskbar-icon {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .taskbar-icon:hover {
            background-color: #333;
        }
        
        .taskbar-icon img {
            filter: brightness(0) invert(1);
            width: 20px;
            height: 20px;
        }
        
        .taskbar-icon.active {
            background-color: #333;
            border-bottom: 2px solid #0078d7;
        }
        
        #clock-container {
            margin-left: auto;
            padding: 0 15px;
            color: white;
            font-size: 12px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            cursor: pointer;
        }
        
        #clock {
            font-size: 12px;
        }
        
        #date {
            font-size: 10px;
            opacity: 0.8;
        }
        
        /* Power options */
        #power-menu {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            border-top: 1px solid #333;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        #power-button {
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        #power-button:hover {
            background-color: #333;
        }
        
        #power-button img {
            width: 16px;
            height: 16px;
            margin-right: 8px;
        }
        
        #power-options {
            position: absolute;
            bottom: 40px;
            left: 10px;
            background-color: #222;
            border: 1px solid #444;
            border-radius: 4px;
            width: 150px;
            display: none;
            z-index: 1002;
        }
        
        .power-option {
            padding: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .power-option:hover {
            background-color: #333;
        }
        
        .power-option img {
            width: 16px;
            height: 16px;
            margin-right: 10px;
        }
        
        /* Janelas do sistema */
        .window {
            position: absolute;
            background-color: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            min-width: 300px;
            min-height: 200px;
            z-index: 10;
        }
        
        .window-header {
            display: flex;
            align-items: center;
            background-color: #0078d7;
            color: white;
            padding: 5px 10px;
            cursor: move;
        }
        
        .window-title {
            flex-grow: 1;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .window-controls {
            display: flex;
        }
        
        .window-control {
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-left: 4px;
            border-radius: 2px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .window-control:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .window-content {
            flex-grow: 1;
            overflow: auto;
            padding: 10px;
            background-color: #f0f0f0;
        }
        
        .window-resizer {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 15px;
            height: 15px;
            cursor: nwse-resize;
        }
        
        /* Server Manager */
        .server-manager {
            display: flex;
            height: 100%;
        }
        
        .sidebar {
            width: 200px;
            background-color: #f0f0f0;
            border-right: 1px solid #ddd;
            overflow-y: auto;
        }
        
        .sidebar-item {
            padding: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .sidebar-item:hover {
            background-color: #e0e0e0;
        }
        
        .sidebar-item.active {
            background-color: #0078d7;
            color: white;
        }
        
        .content-panel {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
        }
        
        /* Estilos para configuração de rede */
        .network-config {
            padding: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .form-actions {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
        
        .btn-primary {
            background-color: #0078d7;
            color: white;
        }
        
        .btn-secondary {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
        }
        
        /* Console */
        .console {
            background-color: #0c0c0c;
            color: #f0f0f0;
            font-family: Consolas, monospace;
            padding: 10px;
            height: 100%;
            overflow-y: auto;
        }
        
        .console-input {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        
        .console-prompt {
            color: #0078d7;
            margin-right: 5px;
        }
        
        .console-command {
            background-color: transparent;
            border: none;
            color: #f0f0f0;
            font-family: Consolas, monospace;
            flex-grow: 1;
            outline: none;
        }
        
        /* Server Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 15px;
        }
        
        .dashboard-card {
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 15px;
        }
        
        .dashboard-card-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #0078d7;
        }
        
        .dashboard-card-content {
            font-size: 14px;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #eee;
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #0078d7;
        }
        
        /* Estilos para IIS Manager */
        .iis-manager {
            display: flex;
            height: 100%;
        }
        
        .site-list {
            border: 1px solid #ddd;
            margin-top: 10px;
        }
        
        .site-item {
            padding: 8px;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
        }
        
        .site-item:last-child {
            border-bottom: none;
        }
        
        .site-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .status-running {
            background-color: #4caf50;
        }
        
        .status-stopped {
            background-color: #f44336;
        }
        
        /* Estilos para Active Directory */
        .ad-users {
            border: 1px solid #ddd;
            margin-top: 10px;
        }
        
        .user-item {
            padding: 8px;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
        }
        
        .user-item:last-child {
            border-bottom: none;
        }
        
        .user-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
        }
        
        .desktop-icon {
            position: absolute;
            width: 80px;
            height: 90px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            cursor: pointer;
        }
        
        .desktop-icon img {
            
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }
        
        .desktop-icon span {
            color: white;
            text-align: center;
            font-size: 12px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        
        .desktop-icon:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .desktop-icon.selected {
            background-color: rgba(0, 120, 215, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }
        
        /* Contexto Menu */
        .context-menu {
            position: absolute;
            background-color: #fff;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }
        
        .context-menu-item {
            padding: 8px 15px;
            cursor: pointer;
        }
        
        .context-menu-item:hover {
            background-color: #f0f0f0;
        }
        
        .context-submenu {
            position: relative;
        }
        
        .context-submenu-content {
            position: absolute;
            left: 100%;
            top: 0;
            background-color: #fff;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: none;
            width: 200px;
        }
        
        .context-submenu:hover .context-submenu-content {
            display: block;
        }
        
        /* Notification Area */
        #notification-area {
            display: flex;
            align-items: center;
            margin-left: auto;
            height: 100%;
        }
        
        .notification-icon {
            width: 20px;
            height: 20px;
            margin: 0 5px;
            cursor: pointer;
        }

        .system-tray-icon {
            width: 30px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        
        .system-tray-icon:hover {
            background-color: #333;
        }
        
        .system-tray-icon img {
           filter: brightness(0) invert(1);
            width: 16px;
            height: 16px;
            opacity: 0.9;
        }
        
        /* Abas */
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 8px 15px;
            cursor: pointer;
            border-right: 1px solid #ddd;
        }
        
        .tab.active {
            background-color: white;
            border-bottom: 2px solid #0078d7;
        }
        
        .tab-content {
            display: none;
            padding: 15px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Estilo para dropdown */
        .dropdown {
            position: relative;
        }
        
        .dropdown-content {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            min-width: 150px;
            display: none;
            z-index: 1000;
        }
        
        .dropdown-item {
            padding: 8px 15px;
            cursor: pointer;
        }
        
        .dropdown-item:hover {
            background-color: #f0f0f0;
        }
        
        /* Estilos para diálogos */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        
        .dialog {
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            width: 400px;
            max-width: 90%;
        }
        
        .dialog-header {
            padding: 10px 15px;
            background-color: #0078d7;
            color: white;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
        }
        
        .dialog-content {
            padding: 15px;
        }
        
        .dialog-footer {
            padding: 10px 15px;
            display: flex;
            justify-content: flex-end;
            border-top: 1px solid #ddd;
        }
        
        /* Estilos para notificações */
        .notification-toast {
            position: fixed;
            bottom: 50px;
            right: 20px;
            background-color: #333;
            color: white;
            padding: 15px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 2000;
            display: none;
            animation: fadeIn 0.3s, fadeOut 0.3s 2.7s;
            animation-fill-mode: forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* Estilos para o Explorer */
        .explorer {
            display: flex;
            height: 100%;
            flex-direction: column;
        }
        
        .folder-tree {
            width: 200px;
            border-right: 1px solid #ddd;
            overflow-y: auto;
            padding: 10px;
        }
        
        .folder-item {
            padding: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .folder-item img {
            width: 16px;
            height: 16px;
            margin-right: 5px;
        }
        
        .folder-item:hover {
            background-color: #f0f0f0;
        }
        
        .file-list {
            flex-grow: 1;
            padding: 10px;
            overflow-y: auto;
        }
        
        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
        }
        
        .file-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            cursor: pointer;
            text-align: center;
        }
        
        .file-item img {
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }
        
        .file-item:hover {
            background-color: #f0f0f0;
        }
        
        .address-bar {
            padding: 5px;
            display: flex;
            align-items: center;
            background-color: #f5f5f5;
            border-bottom: 1px solid #ddd;
        }
        
        .address-bar input {
            flex-grow: 1;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 2px;
        }
        
        .explorer-toolbar {
            padding: 5px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #ddd;
            display: flex;
        }
        
        .toolbar-button {
            padding: 5px 10px;
            margin-right: 5px;
            cursor: pointer;
            border: 1px solid transparent;
            border-radius: 2px;
        }
        
        .toolbar-button:hover {
            border-color: #ddd;
            background-color: #e5e5e5;
        }
        
        /* Estilos para o Editor de Texto */
        .text-editor {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .text-editor-toolbar {
            padding: 5px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #ddd;
            display: flex;
        }
        
        .text-editor-content {
            flex-grow: 1;
            padding: 10px;
            background-color: white;
            overflow: auto;
        }
        
        .text-editor-content textarea {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            resize: none;
            font-family: Consolas, monospace;
            font-size: 14px;
        }
        
        /* Estilos para Google Chrome e Edge */
        .browser {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .browser-toolbar {
            padding: 8px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
        }
        
        .browser-button {
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 5px;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .browser-button:hover {
            background-color: #e0e0e0;
        }
        
        .browser-address {
            flex-grow: 1;
            height: 30px;
            padding: 0 10px;
            border: 1px solid #ddd;
            border-radius: 15px;
            display: flex;
            align-items: center;
        }
        
        .browser-address input {
            flex-grow: 1;
            border: none;
            outline: none;
            background-color: transparent;
        }
        
        .browser-content {
            flex-grow: 1;
            background-color: white;
            overflow: auto;
        }
        
        .browser-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* Estilos para WolfGuard Antivírus */
        .antivirus {
            display: flex;
            flex-direction: column;
            height: 100%;
            background-color: #f9f9f9;
        }
        
        .antivirus-header {
            padding: 20px;
            background-color: #0078d7;
            color: white;
            text-align: center;
        }
        
        .antivirus-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .antivirus-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .antivirus-status {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        
        .status-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            color: white;
        }
        
        .status-protected {
            background-color: #4caf50;
        }
        
        .status-alert {
            background-color: #f44336;
        }
        
        .antivirus-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 20px;
        }
        
        .antivirus-feature {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .antivirus-feature:hover {
            transform: translateY(-5px);
        }
        
        .feature-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .feature-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
        }
        
        .feature-title {
            font-weight: bold;
        }
        
        .feature-status {
            margin-left: auto;
            width: 40px;
            height: 20px;
            border-radius: 10px;
            background-color: #e0e0e0;
            position: relative;
            cursor: pointer;
        }
        
        .feature-status.active {
            background-color: #4caf50;
        }
        
        .feature-status::before {
            content: "";
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: white;
            top: 2px;
            left: 2px;
            transition: transform 0.2s;
        }
        
        .feature-status.active::before {
            transform: translateX(20px);
        }
        
        .feature-description {
            font-size: 12px;
            color: #777;
        }
        
        /* Configurações */
        .settings {
            display: flex;
            height: 100%;
        }
        
        .settings-sidebar {
            width: 220px;
            background-color: #f0f0f0;
            border-right: 1px solid #ddd;
            overflow-y: auto;
        }
        
        .settings-category {
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background-color 0.2s;
        }
        
        .settings-category:hover {
            background-color: #e0e0e0;
        }
        
        .settings-category.active {
            background-color: #0078d7;
            color: white;
        }
        
        .settings-category img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }
        
        .settings-content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .settings-section {
            margin-bottom: 20px;
        }
        
        .settings-section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
        }
        
        .settings-option {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .settings-option-info {
            flex-grow: 1;
        }
        
        .settings-option-title {
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .settings-option-description {
            font-size: 12px;
            color: #777;
        }
        
        .settings-toggle {
            width: 44px;
            height: 22px;
            border-radius: 11px;
            background-color: #ccc;
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .settings-toggle.active {
            background-color: #0078d7;
        }
        
        .settings-toggle::before {
            content: "";
            position: absolute;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background-color: white;
            top: 2px;
            left: 2px;
            transition: transform 0.2s;
        }
        
        .settings-toggle.active::before {
            transform: translateX(22px);
        }
        
        .wallpaper-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .wallpaper-option {
            height: 100px;
            border-radius: 4px;
            background-size: cover;
            background-position: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .wallpaper-option::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.2);
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .wallpaper-option:hover::after {
            opacity: 1;
        }
        
        .wallpaper-option.active {
            border: 2px solid #0078d7;
        }
        
        /* Tela de bloqueio / Shutdown */
        #lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            background-image: url('https://source.unsplash.com/random/1920x1080/?server,datacenter');
            background-size: cover;
            background-position: center;
            z-index: 3000;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .lock-screen-time {
            font-size: 80px;
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .lock-screen-date {
            font-size: 24px;
            color: white;
            margin-bottom: 60px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .lock-screen-message {
            font-size: 24px;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }
        
        .lock-screen-button {
            padding: 10px 20px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        
        .lock-screen-button:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Estilos para diálogo de nova pasta */
        #new-folder-dialog, #new-file-dialog, #rename-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 2100;
            display: none;
        }
        
        .dialog-title {
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .dialog-input {
            width: 300px;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .dialog-buttons {
            display: flex;
            justify-content: flex-end;
        }
        
        .dialog-btn {
            padding: 8px 15px;
            margin-left: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .dialog-btn-primary {
            background-color: #0078d7;
            color: white;
        }
        
        .dialog-btn-secondary {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
        }

        /* Action Center */
        #action-center {
            position: fixed;
            right: 0;
            bottom: 40px;
            width: 300px;
            height: 500px;
            background-color: #222;
            color: white;
            z-index: 2000;
            border-left: 1px solid #444;
            border-top: 1px solid #444;
            display: none;
            flex-direction: column;
            box-shadow: -2px -2px 10px rgba(0,0,0,0.2);
        }

        .action-center-header {
            padding: 15px;
            font-size: 16px;
            font-weight: bold;
            border-bottom: 1px solid #444;
        }

        .action-center-content {
            padding: 15px;
            flex-grow: 1;
            overflow-y: auto;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .quick-action {
            background-color: #333;
            border-radius: 4px;
            height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .quick-action:hover {
            background-color: #444;
        }

        .quick-action img {
            width: 20px;
            height: 20px;
            margin-bottom: 5px;
        }

        .quick-action span {
            font-size: 10px;
        }

        .action-center-section {
            margin-bottom: 15px;
        }

        .action-center-section-title {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.8;
        }

        .brightness-slider {
            width: 100%;
            height: 30px;
            display: flex;
            align-items: center;
        }

        .brightness-slider input {
            width: 100%;
        }

        .volume-control {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .volume-control img {
            width: 16px;
            height: 16px;
            margin-right: 10px;
        }

        .volume-slider {
            flex-grow: 1;
        }

        /* Flyout menus for system tray */
        .flyout-menu {
            position: absolute;
            bottom: 40px;
            background-color: #222;
            color: white;
            border: 1px solid #444;
            border-radius: 4px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            padding: 15px;
            min-width: 250px;
            display: none;
            z-index: 1500;
        }

        .flyout-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        /* Windows Firewall specifics */
        .firewall-panel {
            background-color: white;
            color: black;
            padding: 15px;
            height: 100%;
            overflow-y: auto;
        }

        .firewall-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .firewall-header img {
            width: 32px;
            height: 32px;
            margin-right: 15px;
        }

        .firewall-header-text h2 {
            margin: 0;
            margin-bottom: 5px;
        }

        .firewall-header-text p {
            margin: 0;
            color: #666;
        }

        .firewall-status {
            display: flex;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .firewall-status-icon {
            width: 50px;
            height: 50px;
            margin-right: 15px;
        }

        .firewall-status-text h3 {
            margin: 0;
            margin-bottom: 5px;
        }

        .firewall-status-text p {
            margin: 0;
        }

        .firewall-profiles {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .profile-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #ddd;
        }

        .profile-item:last-child {
            border-bottom: none;
        }

        .profile-name {
            font-weight: bold;
        }

        .profile-status {
            color: green;
        }

        .firewall-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .firewall-action {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .firewall-action:hover {
            background-color: #e0e0e0;
        }

        .firewall-action img {
            width: 32px;
            height: 32px;
            margin-bottom: 10px;
        }

        /* Network flyout specific */
        .network-flyout {
            width: 300px;
        }

        .network-list {
            margin-top: 15px;
        }

        .network-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .network-item:hover {
            background-color: #333;
        }

        .network-item img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .network-item-info {
            flex-grow: 1;
        }

        .network-item-name {
            font-weight: bold;
            margin-bottom: 2px;
        }

        .network-item-status {
            font-size: 12px;
            opacity: 0.8;
        }

        .network-item-connected {
            color: #4caf50;
        }

        /* Sound flyout specific */
        .volume-control-large {
            width: 250px;
        }

        .volume-slider-large {
            width: 100%;
            margin: 15px 0;
        }

        .volume-devices {
            margin-top: 15px;
        }

        .volume-device {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .volume-device:hover {
            background-color: #333;
        }

        .volume-device img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .volume-device-name {
            flex-grow: 1;
        }

        .volume-device.active {
            background-color: #333;
        }

        /* Calendar flyout */
        .calendar-flyout {
            width: 300px;
            padding: 0;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background-color: #333;
        }

        .calendar-title {
            font-weight: bold;
        }

        .calendar-nav {
            display: flex;
        }

        .calendar-nav-btn {
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 2px;
        }

        .calendar-nav-btn:hover {
            background-color: #444;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            padding: 10px;
        }

        .calendar-day-header {
            text-align: center;
            font-size: 12px;
            padding: 5px;
            opacity: 0.8;
        }

        .calendar-day {
            text-align: center;
            padding: 8px;
            cursor: pointer;
            border-radius: 4px;
        }

        .calendar-day:hover {
            background-color: #333;
        }

        .calendar-day.current {
            background-color: #0078d7;
        }

        .calendar-day.other-month {
            opacity: 0.5;
        }

        .calendar-events {
            padding: 15px;
            border-top: 1px solid #444;
        }

        .calendar-events-title {
            font-size: 14px;
            margin-bottom: 10px;
        }

        .calendar-event {
            padding: 8px;
            background-color: #333;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .calendar-event-time {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 2px;
        }

        .calendar-event-title {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="desktop">
        <!-- Ícones da Área de Trabalho -->
        <div class="desktop-icon" style="top: 10px; left: 10px;" onclick="openApp('server-manager')" data-name="Server Manager" data-type="app">
            <img src="m.png" alt="Server Manager">
            <span>Server Manager</span>
        </div>
        
        <div class="desktop-icon" style="top: 110px; left: 10px;" onclick="openApp('network-config')" data-name="Network Configuration" data-type="app">
            <img src="ip.png" alt="Network Configuration">
            <span>Configuração de Rede</span>
        </div>
        
        <div class="desktop-icon" style="top: 210px; left: 10px;" onclick="openApp('active-directory')" data-name="Active Directory" data-type="app">
            <img src="dire.png" alt="Active Directory">
            <span>Diretório</span>
        </div>
        
        <div class="desktop-icon" style="top: 310px; left: 10px;" onclick="openApp('iis-manager')" data-name="IIS Manager" data-type="app">
            <img src="https://cdn-icons-png.flaticon.com/512/1927/1927656.png" alt="IIS Manager">
            <span>IIS Manager</span>
        </div>
        
        <div class="desktop-icon" style="top: 410px; left: 10px;" onclick="openApp('powershell')" data-name="PowerShell" data-type="app">
            <img src="pl.png" alt="PowerShell">
            <span>PowerShell</span>
        </div>
        
        <div class="desktop-icon" style="top: 10px; left: 100px;" onclick="openApp('explorer')" data-name="File Explorer" data-type="app">
            <img src="ex.png" alt="File Explorer">
            <span>Explorador de Arquivos</span>
        </div>
        
        <div class="desktop-icon" style="top: 110px; left: 100px;" onclick="openApp('chrome')" data-name="Google Chrome" data-type="app">
            <img src="https://cdn-icons-png.flaticon.com/512/888/888846.png" alt="Google Chrome">
            <span>Google Chrome</span>
        </div>
        
        <div class="desktop-icon" style="top: 210px; left: 100px;" onclick="openApp('edge')" data-name="Microsoft Edge" data-type="app">
            <img src="https://cdn-icons-png.flaticon.com/512/5968/5968890.png" alt="Microsoft Edge">
            <span>Microsoft Edge</span>
        </div>
        
        <div class="desktop-icon" style="top: 310px; left: 100px;" onclick="openApp('wolfguard')" data-name="WolfGuard" data-type="app">
            <img src="wolf.ico" alt="WolfGuard">
            <span>WolfGuard</span>
        </div>
        
        <div class="desktop-icon" style="top: 410px; left: 100px;" onclick="openApp('settings')" data-name="Settings" data-type="app">
            <img src="cf.png" alt="Settings">
            <span>Configurações</span>
        </div>
        
        <div class="desktop-icon" style="top: 10px; left: 190px;" onclick="openApp('windows-defender')" data-name="Windows Defender" data-type="app">
            <img src="df.png" alt="Windows Defender">
            <span>Windows Defender</span>
        </div>
        
        <div class="desktop-icon" style="top: 110px; left: 190px;" onclick="openApp('firewall')" data-name="Windows Firewall" data-type="app">
            <img src="https://cdn-icons-png.flaticon.com/512/2625/2625815.png" alt="Windows Firewall">
            <span>Windows Firewall</span>
        </div>
    </div>
    
    <div id="taskbar">
        <div id="start-button">
            <img src="w.png" alt="Start">
        </div>
        
        <div id="search-container">
            <input type="text" id="search-box" placeholder="Pesquisar">
        </div>
        
        <div id="open-apps">
            <!-- Aqui serão adicionados ícones de aplicativos abertos -->
        </div>
        
        <div id="notification-area">
            <div class="system-tray-icon" id="action-center-icon" onclick="toggleActionCenter()">
                <img src="https://cdn-icons-png.flaticon.com/512/565/565423.png" alt="Action Center">
            </div>
            <div class="system-tray-icon" id="network-icon" onclick="toggleNetworkFlyout()">
                <img src="https://cdn-icons-png.flaticon.com/512/2099/2099193.png" alt="Network">
            </div>
            <div class="system-tray-icon" id="sound-icon" onclick="toggleVolumeFlyout()">
                <img src="https://cdn-icons-png.flaticon.com/512/727/727269.png" alt="Sound">
            </div>
            <div class="system-tray-icon" id="security-icon" onclick="openSecurityCenter()">
                <img src="wolf.ico" alt="Security">
            </div>
            <div class="system-tray-icon" id="update-icon" onclick="openUpdateSettings()">
                <img src="https://cdn-icons-png.flaticon.com/512/686/686344.png" alt="Updates">
            </div>
            <div id="clock-container" onclick="toggleCalendarFlyout()">
                <div id="clock">00:00</div>
                <div id="date">10/06/2025</div>
            </div>
        </div>
    </div>
    
    <div id="start-menu" style="display: none;">
        <div class="start-menu-header">
            Windows Server 2025 MK
        </div>
        <div class="start-menu-apps">
            <div class="app-icon" onclick="openApp('server-manager')">
                <img src="m.png" alt="Server Manager">
                <span>Server Manager</span>
            </div>
            
            <div class="app-icon" onclick="openApp('network-config')">
                <img src="ip.png" alt="Network Configuration">
                <span>Configuração de Rede</span>
            </div>
            
            <div class="app-icon" onclick="openApp('active-directory')">
                <img src="dire.png" alt="Active Directory">
                <span>Diretório</span>
            </div>
            
            <div class="app-icon" onclick="openApp('iis-manager')">
                <img src="https://cdn-icons-png.flaticon.com/512/1927/1927656.png" alt="IIS Manager">
                <span>IIS Manager</span>
            </div>
            
            <div class="app-icon" onclick="openApp('powershell')">
                <img src="pl.png" alt="PowerShell">
                <span>PowerShell</span>
            </div>
            
            <div class="app-icon" onclick="openApp('explorer')">
                <img src="ex.png" alt="File Explorer">
                <span>Explorador de Arquivos</span>
            </div>
            
            <div class="app-icon" onclick="openApp('hyper-v')">
                <img src="hv.png" alt="Hyper-V">
                <span>Hyper-V Manager</span>
            </div>
            
            <div class="app-icon" onclick="openApp('dns-manager')">
                <img src="dns.png" alt="DNS Manager">
                <span>DNS Manager</span>
            </div>
            
            <div class="app-icon" onclick="openApp('dhcp-manager')">
                <img src="dhcp.png" alt="DHCP Manager">
                <span>DHCP Manager</span>
            </div>
            
            <div class="app-icon" onclick="openApp('windows-admin-center')">
                <img src="aw.png" alt="Windows Admin Center">
                <span>Windows Admin Center</span>
            </div>
            
            <div class="app-icon" onclick="openApp('chrome')">
                <img src="https://cdn-icons-png.flaticon.com/512/888/888846.png" alt="Google Chrome">
                <span>Google Chrome</span>
            </div>
            
            <div class="app-icon" onclick="openApp('edge')">
                <img src="https://cdn-icons-png.flaticon.com/512/5968/5968890.png" alt="Microsoft Edge">
                <span>Microsoft Edge</span>
            </div>
            
            <div class="app-icon" onclick="openApp('group-policy')">
                <img src="policy.png" alt="Group Policy">
                <span>Group Policy</span>
            </div>
            
            <div class="app-icon" onclick="openApp('storage-manager')">
                <img src="ssd.png" alt="Storage Manager">
                <span>Storage Manager</span>
            </div>
            
            <div class="app-icon" onclick="openApp('wolfguard')">
                <img src="wolf.ico" alt="WolfGuard">
                <span>WolfGuard</span>
            </div>
            
            <div class="app-icon" onclick="openApp('settings')">
                <img src="cf.png" alt="Settings">
                <span>Configurações</span>
            </div>
            
            <div class="app-icon" onclick="openApp('firewall')">
                <img src="https://cdn-icons-png.flaticon.com/512/2625/2625815.png" alt="Windows Firewall">
                <span>Windows Firewall</span>
            </div>
            
            <div class="app-icon" onclick="openApp('windows-defender')">
                <img src="df.png" alt="Windows Defender">
                <span>Windows Defender</span>
            </div>
            
            <div class="app-icon" onclick="openApp('remote-desktop')">
                <img src="https://cdn-icons-png.flaticon.com/512/5289/5289039.png" alt="Remote Desktop">
                <span>Remote Desktop</span>
            </div>
            
            <div class="app-icon" onclick="openApp('taskschd')">
                <img src="https://cdn-icons-png.flaticon.com/512/2413/2413423.png" alt="Task Scheduler">
                <span>Agendador de Tarefas</span>
            </div>
        </div>
        
        <div id="power-menu">
            <div id="power-button">
                <img src="https://cdn-icons-png.flaticon.com/512/686/686390.png" alt="Power">
                <span>Energia</span>
            </div>
        </div>
    </div>
    
    <div id="power-options">
        <div class="power-option" onclick="lockComputer()">
            <img src="https://cdn-icons-png.flaticon.com/512/4213/4213604.png" alt="Lock">
            <span>Bloquear</span>
        </div>
        <div class="power-option" onclick="restartComputer()">
            <img src="https://cdn-icons-png.flaticon.com/512/5883/5883751.png" alt="Restart">
            <span>Reiniciar</span>
        </div>
        <div class="power-option" onclick="shutdownComputer()">
            <img src="https://cdn-icons-png.flaticon.com/512/686/686390.png" alt="Shutdown">
            <span>Desligar</span>
        </div>
    </div>
    
    <!-- Menu de contexto para área de trabalho -->
    <div id="context-menu" class="context-menu">
        <div class="context-menu-item" onclick="refreshDesktop()">Atualizar</div>
        <div class="context-menu-item context-submenu">
            Novo
            <div class="context-submenu-content">
                <div class="context-menu-item" onclick="createNewFolder()">Pasta</div>
                <div class="context-menu-item" onclick="createNewFile()">Documento de Texto</div>
            </div>
        </div>
        <div class="context-menu-item" onclick="openDisplaySettings()">Configurações de Exibição</div>
        <div class="context-menu-item" onclick="openPersonalizeSettings()">Personalizar</div>
    </div>
    
    <!-- Menu de contexto para ícones -->
    <div id="icon-context-menu" class="context-menu">
        <div class="context-menu-item" onclick="openSelectedItem()">Abrir</div>
        <div class="context-menu-item" onclick="renameItem()">Renomear</div>
        <div class="context-menu-item" onclick="deleteItem()">Excluir</div>
        <div class="context-menu-item" onclick="showItemProperties()">Propriedades</div>
    </div>
    
    <!-- Diálogo de personalização -->
    <div id="personalize-dialog" class="dialog-overlay">
        <div class="dialog">
            <div class="dialog-header">
                Personalização
            </div>
            <div class="dialog-content">
                <div class="form-group">
                    <label>Papel de parede</label>
                    <p>A imagem atual windows 2025</p>
                </div>
                <div class="form-group">
                    <label>Cor de destaque</label>
                    <input type="color" id="accent-color" value="#0078d7">
                </div>
            </div>
            <div class="dialog-footer">
                <button class="btn btn-secondary" onclick="closeDialog('personalize-dialog')">Cancelar</button>
                <button class="btn btn-primary" onclick="applyPersonalization()">Aplicar</button>
            </div>
        </div>
    </div>
    
    <!-- Diálogo de nova pasta -->
    <div id="new-folder-dialog">
        <div class="dialog-title">Nova Pasta</div>
        <input type="text" id="new-folder-name" class="dialog-input" value="Nova pasta" placeholder="Digite o nome da pasta">
        <div class="dialog-buttons">
            <button class="dialog-btn dialog-btn-secondary" onclick="closeNewFolderDialog()">Cancelar</button>
            <button class="dialog-btn dialog-btn-primary" onclick="confirmNewFolder()">Criar</button>
        </div>
    </div>
    
    <!-- Diálogo de novo arquivo -->
    <div id="new-file-dialog">
        <div class="dialog-title">Novo Documento de Texto</div>
        <input type="text" id="new-file-name" class="dialog-input" value="Novo documento.txt" placeholder="Digite o nome do arquivo">
        <div class="dialog-buttons">
            <button class="dialog-btn dialog-btn-secondary" onclick="closeNewFileDialog()">Cancelar</button>
            <button class="dialog-btn dialog-btn-primary" onclick="confirmNewFile()">Criar</button>
        </div>
    </div>
    
    <!-- Diálogo de renomeação -->
    <div id="rename-dialog">
        <div class="dialog-title">Renomear</div>
        <input type="text" id="rename-input" class="dialog-input" placeholder="Digite o novo nome">
        <div class="dialog-buttons">
            <button class="dialog-btn dialog-btn-secondary" onclick="closeRenameDialog()">Cancelar</button>
            <button class="dialog-btn dialog-btn-primary" onclick="confirmRename()">Renomear</button>
        </div>
    </div>
    
    <!-- Notification Toast -->
    <div id="notification-toast" class="notification-toast">
        Configurações salvas com sucesso!
    </div>
    
    <!-- Tela de bloqueio / desligamento -->
    <div id="lock-screen">
        <div class="lock-screen-time" id="lock-screen-time">00:00</div>
        <div class="lock-screen-date" id="lock-screen-date">Segunda-feira, 10 de junho</div>
        <div class="lock-screen-message" id="lock-screen-message">Computador bloqueado</div>
        <button class="lock-screen-button" id="lock-screen-button" onclick="unlockComputer()">Desbloquear</button>
    </div>
    
    <!-- Action Center -->
    <div id="action-center">
        <div class="action-center-header">
            Central de Ações
        </div>
        <div class="action-center-content">
            <div class="quick-actions">
                <div class="quick-action" onclick="toggleNetworkFlyout()">
                    <img src="https://cdn-icons-png.flaticon.com/512/2099/2099193.png" alt="Network">
                    <span>Rede</span>
                </div>
                <div class="quick-action" onclick="toggleVolumeFlyout()">
                    <img src="https://cdn-icons-png.flaticon.com/512/727/727269.png" alt="Volume">
                    <span>Volume</span>
                </div>
                <div class="quick-action" onclick="toggleBluetooth()">
                    <img src="https://cdn-icons-png.flaticon.com/512/81/81113.png" alt="Bluetooth">
                    <span>Bluetooth</span>
                </div>
                <div class="quick-action" onclick="toggleAirplaneMode()">
                    <img src="https://cdn-icons-png.flaticon.com/512/5735/5735261.png" alt="Airplane Mode">
                    <span>Modo Avião</span>
                </div>
                <div class="quick-action" onclick="toggleLocation()">
                    <img src="https://cdn-icons-png.flaticon.com/512/854/854878.png" alt="Location">
                    <span>Localização</span>
                </div>
                <div class="quick-action" onclick="openApp('settings')">
                    <img src="cf.png" alt="Settings">
                    <span>Configurações</span>
                </div>
                <div class="quick-action" onclick="openApp('wolfguard')">
                    <img src="wolf.ico" alt="WolfGuard">
                    <span>WolfGuard</span>
                </div>
            </div>
            
            <div class="action-center-section">
                <div class="action-center-section-title">Brilho</div>
                <div class="brightness-slider">
                    <input type="range" min="0" max="100" value="75" onchange="adjustBrightness(this.value)">
                </div>
            </div>
            
            <div class="action-center-section">
                <div class="action-center-section-title">Volume</div>
                <div class="volume-control">
                    <img src="https://cdn-icons-png.flaticon.com/512/727/727269.png" alt="Volume">
                    <input type="range" class="volume-slider" min="0" max="100" value="50" onchange="adjustVolume(this.value)">
                </div>
            </div>
            
            <div class="action-center-section">
                <div class="action-center-section-title">Notificações</div>
                <div class="notification-item">
                    <p>Sem notificações no momento.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Network Flyout -->
    <div id="network-flyout" class="flyout-menu network-flyout">
        <div class="flyout-title">Rede</div>
        <div class="network-list">
            <div class="network-item">
                <img src="https://cdn-icons-png.flaticon.com/512/2099/2099193.png" alt="Network">
                <div class="network-item-info">
                    <div class="network-item-name">SERVIDOR-REDE</div>
                    <div class="network-item-status network-item-connected">Conectado</div>
                </div>
            </div>
            <div class="network-item">
                <img src="https://cdn-icons-png.flaticon.com/512/2099/2099193.png" alt="Network">
                <div class="network-item-info">
                    <div class="network-item-name">REDE-CORPORATIVA</div>
                    <div class="network-item-status">Protegida</div>
                </div>
            </div>
            <div class="network-item">
                <img src="https://cdn-icons-png.flaticon.com/512/2099/2099193.png" alt="Network">
                <div class="network-item-info">
                    <div class="network-item-name">ConvidadosWiFi</div>
                    <div class="network-item-status">Aberta</div>
                </div>
            </div>
        </div>
        <div style="margin-top: 15px;">
            <button class="btn btn-primary" style="width: 100%;" onclick="openApp('network-config')">Configurações de Rede</button>
        </div>
    </div>
    
    <!-- Volume Flyout -->
    <div id="volume-flyout" class="flyout-menu">
        <div class="flyout-title">Volume</div>
        <div class="volume-control-large">
            <img src="https://cdn-icons-png.flaticon.com/512/727/727269.png" alt="Volume" style="width: 24px; height: 24px;">
            <input type="range" class="volume-slider-large" min="0" max="100" value="50" onchange="adjustVolume(this.value)">
            <div style="text-align: right;">50%</div>
        </div>
        <div class="volume-devices">
            <div class="volume-device active">
                <img src="https://cdn-icons-png.flaticon.com/512/860/860963.png" alt="Speakers">
                <div class="volume-device-name">Alto-falantes (Realtek Audio)</div>
            </div>
            <div class="volume-device">
                <img src="https://cdn-icons-png.flaticon.com/512/3065/3065882.png" alt="Headphones">
                <div class="volume-device-name">Fones de ouvido</div>
            </div>
        </div>
        <div style="margin-top: 15px; padding: 0 10px;">
            <button class="btn btn-primary" style="width: 100%;" onclick="openSoundSettings()">Configurações de Som</button>
        </div>
    </div>
    
    <!-- Calendar Flyout -->
    <div id="calendar-flyout" class="flyout-menu calendar-flyout">
        <div class="calendar-header">
            <div class="calendar-title">Junho 2025</div>
            <div class="calendar-nav">
                <div class="calendar-nav-btn" onclick="changeCalendarMonth(-1)">◀</div>
                <div class="calendar-nav-btn" onclick="changeCalendarMonth(1)">▶</div>
            </div>
        </div>
        <div class="calendar-grid" id="calendar-grid">
            <!-- Calendar will be filled by JS -->
        </div>
        <div class="calendar-events">
            <div class="calendar-events-title">Agenda de Hoje</div>
            <div class="calendar-event">
                <div class="calendar-event-time">09:00 - 10:30</div>
                <div class="calendar-event-title">Reunião de TI</div>
            </div>
            <div class="calendar-event">
                <div class="calendar-event-time">14:00 - 15:00</div>
                <div class="calendar-event-title">Manutenção do Servidor</div>
            </div>
        </div>
    </div>
    
    <script>
        // Estado do sistema
        let state = {
            windows: {},
            computerName: "WIN-SRV2025",
            ipConfig: {
                ipAddress: "192.168.1.100",
                subnetMask: "255.255.255.0",
                gateway: "192.168.1.1",
                dns1: "192.168.1.1",
                dns2: "8.8.8.8",
                dhcpEnabled: false
            },
            activeDirectory: {
                domain: "example.local",
                forestLevel: "Windows Server 2025 MK",
                domainLevel: "Windows Server 2025 MK",
                users: [
                    { name: "Administrator", type: "User", enabled: true },
                    { name: "Guest", type: "User", enabled: false },
                    { name: "John Doe", type: "User", enabled: true },
                    { name: "Jane Smith", type: "User", enabled: true },
                    { name: "IT Admins", type: "Group", enabled: true },
                    { name: "Sales Department", type: "Group", enabled: true }
                ]
            },
            iis: {
                sites: [
                    { name: "Default Web Site", status: "running", physicalPath: "C:\\inetpub\\wwwroot", bindings: "http/*:80:" },
                    { name: "Intranet", status: "running", physicalPath: "C:\\inetpub\\intranet", bindings: "http/*:8080:" },
                    { name: "API Service", status: "stopped", physicalPath: "C:\\inetpub\\api", bindings: "http/*:8081:" }
                ]
            },
            storage: {
                drives: [
                    { letter: "C", label: "System", type: "NTFS", totalSpace: 500, usedSpace: 120 },
                    { letter: "D", label: "Data", type: "NTFS", totalSpace: 1000, usedSpace: 350 },
                    { letter: "E", label: "Backup", type: "NTFS", totalSpace: 2000, usedSpace: 800 }
                ]
            },
            hyper_v: {
                vms: [
                    { name: "DC-01", status: "running", memory: "8GB", cpus: 4, notes: "Domain Controller" },
                    { name: "SQL-01", status: "running", memory: "16GB", cpus: 8, notes: "SQL Server" },
                    { name: "WEB-01", status: "stopped", memory: "4GB", cpus: 2, notes: "Web Server" }
                ]
            },
            dns: {
                zones: [
                    { name: "example.local", type: "Primary", records: 48 },
                    { name: "168.192.in-addr.arpa", type: "Reverse Lookup", records: 35 }
                ]
            },
            dhcp: {
                scopes: [
                    { name: "LAN", range: "192.168.1.100-192.168.1.200", leased: 15, reservations: 5 },
                    { name: "WiFi", range: "192.168.2.100-192.168.2.200", leased: 27, reservations: 3 }
                ]
            },
            fileSystem: {
                desktop: [],
                "C:": {
                    "Windows": {
                        "System32": { type: "folder", items: [] },
                        "Logs": { type: "folder", items: [] }
                    },
                    "inetpub": {
                        "wwwroot": { type: "folder", items: [] }
                    },
                    "Program Files": { type: "folder", items: [] },
                    "Users": { type: "folder", items: [] }
                },
                "D:": {
                    "Data": { type: "folder", items: [] },
                    "Shares": {
                        "Public": { type: "folder", items: [] },
                        "Departments": { type: "folder", items: [] }
                    }
                }
            },
            windowSettings: {
                positions: {}
            },
            settings: {
                wallpaper: 1, // 1, 2, ou 3
                accentColor: "#0078d7",
                firewall: true,
                antivirus: true,
                autoUpdate: true,
                wolfGuardFeatures: {
                    realTimeScan: true,
                    webProtection: true,
                    firewall: true,
                    ransomwareProtection: true
                },
                volume: 50,
                brightness: 75,
                nightLight: false,
                bluetooth: true,
                location: true,
                airplaneMode: false
            },
            selectedItem: null,
            currentMonth: 5, // June (0-based)
            currentYear: 2025,
            notifications: []
        };
        
        // Carrega os dados do localStorage se existirem
        function loadStateFromLocalStorage() {
            const savedState = localStorage.getItem('windowsServerState');
            if (savedState) {
                try {
                    const parsedState = JSON.parse(savedState);
                    // Mesclar com o state padrão para garantir que todas as propriedades estejam presentes
                    state = {...state, ...parsedState};
                    
                    // Aplicar configurações carregadas
                    applyWallpaper(state.settings.wallpaper);
                    document.documentElement.style.setProperty('--accent-color', state.settings.accentColor);
                    
                    // Recriar ícones do desktop
                    refreshDesktopIcons();
                } catch (e) {
                    console.error('Erro ao carregar o estado do localStorage:', e);
                }
            }
        }
        
        // Salva os dados no localStorage
        function saveStateToLocalStorage() {
            try {
                // Não queremos salvar as janelas abertas
                const stateToSave = {...state};
                delete stateToSave.windows;
                
                localStorage.setItem('windowsServerState', JSON.stringify(stateToSave));
            } catch (e) {
                console.error('Erro ao salvar o estado no localStorage:', e);
            }
        }
        
        // Atualiza os ícones do desktop com base no estado atual
        function refreshDesktopIcons() {
            // Primeiro, remover todos os ícones de arquivos e pastas do desktop
            const desktop = document.getElementById('desktop');
            const existingIcons = desktop.querySelectorAll('.desktop-icon[data-type="file"], .desktop-icon[data-type="folder"]');
            existingIcons.forEach(icon => desktop.removeChild(icon));
            
            // Agora, adicionar os ícones com base no fileSystem
            if (state.fileSystem.desktop && Array.isArray(state.fileSystem.desktop)) {
                let startX = 10;
                let startY = 510;
                let iconCount = 0;
                
                state.fileSystem.desktop.forEach(item => {
                    // Decidir a posição do ícone
                    let iconX = startX + (iconCount % 5) * 90;
                    let iconY = startY + Math.floor(iconCount / 5) * 100;
                    
                    // Criar o ícone
                    const iconElement = document.createElement('div');
                    iconElement.className = 'desktop-icon';
                    iconElement.style.top = iconY + 'px';
                    iconElement.style.left = iconX + 'px';
                    iconElement.setAttribute('data-name', item.name);
                    iconElement.setAttribute('data-type', item.type);
                    
                    // Adicionar imagem e texto apropriados
                    let iconSrc = '';
                    if (item.type === 'folder') {
                        iconSrc = 'https://cdn-icons-png.flaticon.com/512/716/716784.png';
                        iconElement.setAttribute('ondblclick', `openFolder('${item.name}')`);
                    } else if (item.type === 'file') {
                        if (item.name.endsWith('.txt')) {
                            iconSrc = 'https://cdn-icons-png.flaticon.com/512/3025/3025906.png';
                            iconElement.setAttribute('ondblclick', `openTextFile('${item.name}')`);
                        } else {
                            iconSrc = 'https://cdn-icons-png.flaticon.com/512/2246/2246713.png';
                            iconElement.setAttribute('ondblclick', `openFile('${item.name}')`);
                        }
                    }
                    
                    iconElement.innerHTML = `
                        <img src="${iconSrc}" alt="${item.name}">
                        <span>${item.name}</span>
                    `;
                    
                    // Adicionar ao desktop
                    desktop.appendChild(iconElement);
                    
                    // Incrementar contador
                    iconCount++;
                });
            }
            
            // Adicionar eventos aos ícones
            addIconEvents();
        }
        
        // Adicionar eventos aos ícones do desktop
        function addIconEvents() {
            document.querySelectorAll('.desktop-icon').forEach(icon => {
                // Evento de clique para seleção
                icon.addEventListener('click', function(event) {
                    // Remover seleção anterior
                    document.querySelectorAll('.desktop-icon.selected').forEach(selected => {
                        selected.classList.remove('selected');
                    });
                    
                    // Adicionar seleção ao ícone atual
                    this.classList.add('selected');
                    
                    // Guardar referência ao item selecionado
                    state.selectedItem = {
                        name: this.getAttribute('data-name'),
                        type: this.getAttribute('data-type')
                    };
                    
                    // Impedir que o evento se propague para o desktop
                    event.stopPropagation();
                });
                
                // Evento de clique direito para menu de contexto
                icon.addEventListener('contextmenu', function(event) {
                    event.preventDefault();
                    
                    // Remover seleção anterior
                    document.querySelectorAll('.desktop-icon.selected').forEach(selected => {
                        selected.classList.remove('selected');
                    });
                    
                    // Adicionar seleção ao ícone atual
                    this.classList.add('selected');
                    
                    // Guardar referência ao item selecionado
                    state.selectedItem = {
                        name: this.getAttribute('data-name'),
                        type: this.getAttribute('data-type')
                    };
                    
                    // Mostrar menu de contexto
                    const iconContextMenu = document.getElementById('icon-context-menu');
                    iconContextMenu.style.display = 'block';
                    iconContextMenu.style.left = event.pageX + 'px';
                    iconContextMenu.style.top = event.pageY + 'px';
                    
                    // Impedir que o evento se propague para o desktop
                    event.stopPropagation();
                });
            });
        }
        
        // Manter o controle do Z-index
        let topZIndex = 100;
        
        // Atualizar relógio
        function updateClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            document.getElementById('clock').textContent = `${hours}:${minutes}`;
            
            // Atualizar data na barra de tarefas
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
            document.getElementById('date').textContent = now.toLocaleDateString('pt-BR', options);
            
            // Também atualizar relógio da tela de bloqueio
            document.getElementById('lock-screen-time').textContent = `${hours}:${minutes}`;
            
            // Atualizar data da tela de bloqueio
            const lockOptions = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
            document.getElementById('lock-screen-date').textContent = now.toLocaleDateString('pt-BR', lockOptions);
        }
        
        setInterval(updateClock, 1000);
        updateClock();
        
        // Toggle Start Menu
        document.getElementById('start-button').addEventListener('click', function() {
            const startMenu = document.getElementById('start-menu');
            startMenu.style.display = startMenu.style.display === 'none' ? 'flex' : 'none';
            
            // Fechar outros menus ao abrir o menu iniciar
            document.getElementById('action-center').style.display = 'none';
            document.getElementById('network-flyout').style.display = 'none';
            document.getElementById('volume-flyout').style.display = 'none';
            document.getElementById('calendar-flyout').style.display = 'none';
        });
        
        // Fechar Start Menu ao clicar fora
        document.addEventListener('click', function(e) {
            const startMenu = document.getElementById('start-menu');
            const startButton = document.getElementById('start-button');
            
            if (!startButton.contains(e.target) && !startMenu.contains(e.target) && startMenu.style.display !== 'none') {
                startMenu.style.display = 'none';
            }
        });
        
        // Remover seleção ao clicar no desktop
        document.getElementById('desktop').addEventListener('click', function(e) {
            if (e.target === this) {
                document.querySelectorAll('.desktop-icon.selected').forEach(selected => {
                    selected.classList.remove('selected');
                });
                state.selectedItem = null;
            }
        });
        
        // Menu de contexto para área de trabalho
        document.getElementById('desktop').addEventListener('contextmenu', function(e) {
            // Verificar se o clique foi diretamente no desktop e não em um ícone
            if (e.target === this) {
                e.preventDefault();
                const contextMenu = document.getElementById('context-menu');
                contextMenu.style.display = 'block';
                contextMenu.style.left = e.pageX + 'px';
                contextMenu.style.top = e.pageY + 'px';
            }
        });
        
        // Fechar menu de contexto ao clicar fora
        document.addEventListener('click', function(e) {
            document.getElementById('context-menu').style.display = 'none';
            document.getElementById('icon-context-menu').style.display = 'none';
        });
        
        // Toggle Power Options
        document.getElementById('power-button').addEventListener('click', function(e) {
            e.stopPropagation();
            const powerOptions = document.getElementById('power-options');
            powerOptions.style.display = powerOptions.style.display === 'none' ? 'block' : 'none';
        });
        
        // Fechar Power Options ao clicar fora
        document.addEventListener('click', function(e) {
            const powerOptions = document.getElementById('power-options');
            const powerButton = document.getElementById('power-button');
            
            if (!powerButton.contains(e.target) && !powerOptions.contains(e.target)) {
                powerOptions.style.display = 'none';
            }
        });
        
        // Toggle Action Center
        function toggleActionCenter() {
            const actionCenter = document.getElementById('action-center');
            actionCenter.style.display = actionCenter.style.display === 'none' ? 'flex' : 'none';
            
            // Fechar outros menus ao abrir a central de ações
            document.getElementById('start-menu').style.display = 'none';
            document.getElementById('network-flyout').style.display = 'none';
            document.getElementById('volume-flyout').style.display = 'none';
            document.getElementById('calendar-flyout').style.display = 'none';
        }
        
        // Toggle Network Flyout
        function toggleNetworkFlyout() {
            const networkFlyout = document.getElementById('network-flyout');
            networkFlyout.style.display = networkFlyout.style.display === 'none' ? 'block' : 'none';
            
            // Posicionar o flyout
            networkFlyout.style.right = '120px';
            
            // Fechar outros menus
            document.getElementById('start-menu').style.display = 'none';
            document.getElementById('action-center').style.display = 'none';
            document.getElementById('volume-flyout').style.display = 'none';
            document.getElementById('calendar-flyout').style.display = 'none';
        }
        
        // Toggle Volume Flyout
        function toggleVolumeFlyout() {
            const volumeFlyout = document.getElementById('volume-flyout');
            volumeFlyout.style.display = volumeFlyout.style.display === 'none' ? 'block' : 'none';
            
            // Posicionar o flyout
            volumeFlyout.style.right = '90px';
            
            // Fechar outros menus
            document.getElementById('start-menu').style.display = 'none';
            document.getElementById('action-center').style.display = 'none';
            document.getElementById('network-flyout').style.display = 'none';
            document.getElementById('calendar-flyout').style.display = 'none';
        }
        
        // Toggle Calendar Flyout
        function toggleCalendarFlyout() {
            const calendarFlyout = document.getElementById('calendar-flyout');
            calendarFlyout.style.display = calendarFlyout.style.display === 'none' ? 'block' : 'none';
            
            // Posicionar o flyout
            calendarFlyout.style.right = '5px';
            
            // Atualizar calendário
            if (calendarFlyout.style.display === 'block') {
                updateCalendar();
            }
            
            // Fechar outros menus
            document.getElementById('start-menu').style.display = 'none';
            document.getElementById('action-center').style.display = 'none';
            document.getElementById('network-flyout').style.display = 'none';
            document.getElementById('volume-flyout').style.display = 'none';
        }
        
        // Atualizar calendário
        function updateCalendar() {
            const calendarGrid = document.getElementById('calendar-grid');
            calendarGrid.innerHTML = '';
            
            // Adicionar cabeçalhos de dias da semana
            const days = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
            days.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });
            
            // Obter o primeiro dia do mês
            const firstDay = new Date(state.currentYear, state.currentMonth, 1);
            const startDay = firstDay.getDay(); // 0 = Domingo, 6 = Sábado
            
            // Obter o último dia do mês
            const lastDay = new Date(state.currentYear, state.currentMonth + 1, 0);
            const totalDays = lastDay.getDate();
            
            // Obter o mês anterior para preencher os dias
            const prevMonthLastDay = new Date(state.currentYear, state.currentMonth, 0);
            const prevMonthDays = prevMonthLastDay.getDate();
            
            // Dia atual
            const today = new Date();
            const isCurrentMonth = today.getMonth() === state.currentMonth && today.getFullYear() === state.currentYear;
            const currentDay = isCurrentMonth ? today.getDate() : -1;
            
            // Preencher dias do mês anterior
            for (let i = 0; i < startDay; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day other-month';
                day.textContent = prevMonthDays - startDay + i + 1;
                calendarGrid.appendChild(day);
            }
            
            // Preencher dias do mês atual
            for (let i = 1; i <= totalDays; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                if (i === currentDay) {
                    day.classList.add('current');
                }
                day.textContent = i;
                calendarGrid.appendChild(day);
            }
            
            // Preencher dias do próximo mês
            const remainingCells = 42 - (startDay + totalDays); // 6 linhas x 7 dias = 42 células
            for (let i = 1; i <= remainingCells; i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day other-month';
                day.textContent = i;
                calendarGrid.appendChild(day);
            }
            
            // Atualizar título do calendário
            const months = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            document.querySelector('.calendar-title').textContent = `${months[state.currentMonth]} ${state.currentYear}`;
        }
        
        // Alterar mês do calendário
        function changeCalendarMonth(delta) {
            state.currentMonth += delta;
            if (state.currentMonth > 11) {
                state.currentMonth = 0;
                state.currentYear++;
            } else if (state.currentMonth < 0) {
                state.currentMonth = 11;
                state.currentYear--;
            }
            updateCalendar();
        }
        
        // Ajustar volume
        function adjustVolume(value) {
            state.settings.volume = parseInt(value);
            document.querySelectorAll('.volume-slider-large').forEach(slider => {
                slider.value = value;
            });
            document.querySelector('.volume-flyout div[style="text-align: right;"]').textContent = `${value}%`;
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Ajustar brilho
        function adjustBrightness(value) {
            state.settings.brightness = parseInt(value);
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Toggle Bluetooth
        function toggleBluetooth() {
            state.settings.bluetooth = !state.settings.bluetooth;
            showNotification(`Bluetooth ${state.settings.bluetooth ? 'ativado' : 'desativado'}`);
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Toggle Airplane Mode
        function toggleAirplaneMode() {
            state.settings.airplaneMode = !state.settings.airplaneMode;
            showNotification(`Modo Avião ${state.settings.airplaneMode ? 'ativado' : 'desativado'}`);
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Toggle Night Light
        function toggleNightLight() {
            state.settings.nightLight = !state.settings.nightLight;
            
            // Aplicar efeito visual
            if (state.settings.nightLight) {
                document.body.style.filter = "sepia(20%) brightness(90%)";
            } else {
                document.body.style.filter = "none";
            }
            
            showNotification(`Luz Noturna ${state.settings.nightLight ? 'ativada' : 'desativada'}`);
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Toggle Location
        function toggleLocation() {
            state.settings.location = !state.settings.location;
            showNotification(`Localização ${state.settings.location ? 'ativada' : 'desativada'}`);
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Abrir configurações de som
        function openSoundSettings() {
            document.getElementById('volume-flyout').style.display = 'none';
            openApp('settings');
            // Implementar navegação para as configurações de som
        }
        
        // Funcionalidade de pesquisa
        document.getElementById('search-box').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                const searchQuery = this.value.toLowerCase().trim();
                if (searchQuery) {
                    searchSystem(searchQuery);
                }
            }
        });
        
        // Função de pesquisa no sistema
        function searchSystem(query) {
            // Lista de aplicativos pesquisáveis
            const apps = [
                { name: 'Server Manager', id: 'server-manager' },
                { name: 'Configuração de Rede', id: 'network-config' },
                { name: 'Active Directory', id: 'active-directory' },
                { name: 'IIS Manager', id: 'iis-manager' },
                { name: 'PowerShell', id: 'powershell' },
                { name: 'Explorador de Arquivos', id: 'explorer' },
                { name: 'Google Chrome', id: 'chrome' },
                { name: 'Microsoft Edge', id: 'edge' },
                { name: 'WolfGuard', id: 'wolfguard' },
                { name: 'Configurações', id: 'settings' },
                { name: 'Hyper-V Manager', id: 'hyper-v' },
                { name: 'DNS Manager', id: 'dns-manager' },
                { name: 'DHCP Manager', id: 'dhcp-manager' },
                { name: 'Windows Admin Center', id: 'windows-admin-center' },
                { name: 'Group Policy', id: 'group-policy' },
                { name: 'Storage Manager', id: 'storage-manager' },
                { name: 'Windows Defender', id: 'windows-defender' },
                { name: 'Windows Firewall', id: 'firewall' },
                { name: 'Remote Desktop', id: 'remote-desktop' },
                { name: 'Agendador de Tarefas', id: 'taskschd' }
            ];
            
            // Procurar por aplicativos que correspondam à consulta
            const matchingApp = apps.find(app => app.name.toLowerCase().includes(query));
            
            if (matchingApp) {
                // Abrir o aplicativo correspondente
                openApp(matchingApp.id);
                // Limpar campo de pesquisa
                document.getElementById('search-box').value = '';
            } else {
                // Tentar encontrar arquivos ou pastas no desktop
                const desktopItems = state.fileSystem.desktop || [];
                const matchingItem = desktopItems.find(item => item.name.toLowerCase().includes(query));
                
                if (matchingItem) {
                    if (matchingItem.type === 'folder') {
                        openFolder(matchingItem.name);
                    } else if (matchingItem.type === 'file' && matchingItem.name.endsWith('.txt')) {
                        openTextFile(matchingItem.name);
                    }
                    document.getElementById('search-box').value = '';
                } else {
                    // Nenhum resultado encontrado
                    showNotification('Nenhum resultado encontrado para: ' + query);
                }
            }
        }
        
        // Aplicar papel de parede
        function applyWallpaper(wallpaperNumber) {
            let wallpaperUrl = '';
            
            switch (wallpaperNumber) {
                case 1:
                    wallpaperUrl = 'd.jpg';
                    break;
                case 2:
                    wallpaperUrl = 'd.jpg';
                    break;
                case 3:
                    wallpaperUrl = 'd.jpg';
                    break;
                default:
                    wallpaperUrl = 'https://source.unsplash.com/random/1920x1080/?server,datacenter';
            }
            
            document.getElementById('desktop').style.backgroundImage = `url('${wallpaperUrl}')`;
            state.settings.wallpaper = wallpaperNumber;
            
            // Também atualizar a tela de bloqueio com o mesmo papel de parede
            document.getElementById('lock-screen').style.backgroundImage = `url('${wallpaperUrl}')`;
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Abrir configurações de personalização
        function openPersonalizeSettings() {
            document.getElementById('personalize-dialog').style.display = 'flex';
            
            // Marcar o papel de parede atual como selecionado
            document.querySelectorAll('.wallpaper-option').forEach(option => {
                option.classList.remove('active');
                if (parseInt(option.getAttribute('data-wallpaper')) === state.settings.wallpaper) {
                    option.classList.add('active');
                }
            });
            
            // Definir a cor de destaque atual
            document.getElementById('accent-color').value = state.settings.accentColor;
        }
        
        // Fechar diálogo
        function closeDialog(id) {
            document.getElementById(id).style.display = 'none';
        }
        
        // Aplicar configurações de personalização
        function applyPersonalization() {
            // Obter papel de parede selecionado
            const selectedWallpaper = document.querySelector('.wallpaper-option.active');
            if (selectedWallpaper) {
                const wallpaperNumber = parseInt(selectedWallpaper.getAttribute('data-wallpaper'));
                applyWallpaper(wallpaperNumber);
            }
            
            // Obter cor de destaque
            const accentColor = document.getElementById('accent-color').value;
            document.documentElement.style.setProperty('--accent-color', accentColor);
            state.settings.accentColor = accentColor;
            
            // Fechar diálogo
            closeDialog('personalize-dialog');
            
            // Mostrar notificação
            showNotification('Configurações de personalização aplicadas');
            
            // Salvar configurações
            saveStateToLocalStorage();
        }
        
        // Mostrar notificação
        function showNotification(message) {
            const toast = document.getElementById('notification-toast');
            toast.textContent = message;
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }
        
        // Função para abrir aplicativos
        function openApp(appId) {
            // Fechar menu iniciar
            document.getElementById('start-menu').style.display = 'none';
            
            // Verificar se a janela já existe
            if (state.windows[appId]) {
                // Trazer para frente
                bringToFront(state.windows[appId]);
                return;
            }
            
            // Criar janela
            const windowElement = document.createElement('div');
            windowElement.className = 'window';
            windowElement.id = 'window-' + appId;
            windowElement.style.width = '800px';
            windowElement.style.height = '600px';
            windowElement.style.left = '50%';
            windowElement.style.top = '50%';
            windowElement.style.transform = 'translate(-50%, -50%)';
            windowElement.style.zIndex = ++topZIndex;
            
            // Determinar título e conteúdo com base no appId
            let title = '';
            let content = '';
            
            switch (appId) {
                case 'server-manager':
                    title = 'Server Manager';
                    content = createServerManagerContent();
                    break;
                case 'network-config':
                    title = 'Configuração de Rede';
                    content = createNetworkConfigContent();
                    break;
                case 'active-directory':
                    title = 'Active Directory Users and Computers';
                    content = createActiveDirectoryContent();
                    break;
                case 'iis-manager':
                    title = 'Internet Information Services (IIS) Manager';
                    content = createIISManagerContent();
                    break;
                case 'powershell':
                    title = 'Windows PowerShell';
                    content = createPowerShellContent();
                    break;
                case 'explorer':
                    title = 'Explorador de Arquivos';
                    content = createExplorerContent();
                    break;
                case 'hyper-v':
                    title = 'Hyper-V Manager';
                    content = createHyperVContent();
                    break;
                case 'dns-manager':
                    title = 'DNS Manager';
                    content = createDNSManagerContent();
                    break;
                case 'dhcp-manager':
                    title = 'DHCP Manager';
                    content = createDHCPManagerContent();
                    break;
                case 'windows-admin-center':
                    title = 'Windows Admin Center';
                    content = createWindowsAdminCenterContent();
                    break;
                case 'group-policy':
                    title = 'Group Policy Management';
                    content = createGroupPolicyContent();
                    break;
                case 'storage-manager':
                    title = 'Storage Manager';
                    content = createStorageManagerContent();
                    break;
                case 'chrome':
                    title = 'Google Chrome';
                    content = createBrowserContent('chrome');
                    break;
                case 'edge':
                    title = 'Microsoft Edge';
                    content = createBrowserContent('edge');
                    break;
                case 'wolfguard':
                    title = 'WolfGuard Antivírus';
                    content = createWolfGuardContent();
                    break;
                case 'settings':
                    title = 'Configurações';
                    content = createSettingsContent();
                    break;
                case 'firewall':
                    title = 'Windows Defender Firewall';
                    content = createFirewallContent();
                    break;
                case 'windows-defender':
                    title = 'Windows Defender';
                    content = createWindowsDefenderContent();
                    break;
                case 'remote-desktop':
                    title = 'Remote Desktop';
                    content = createRemoteDesktopContent();
                    break;
                case 'taskschd':
                    title = 'Agendador de Tarefas';
                    content = createTaskSchedulerContent();
                    break;
                default:
                    title = 'Aplicativo';
                    content = '<div style="padding: 20px;">Conteúdo do aplicativo</div>';
            }
            
            // Estrutura da janela
            windowElement.innerHTML = `
                <div class="window-header">
                    <div class="window-title">${title}</div>
                    <div class="window-controls">
                        <div class="window-control window-minimize" onclick="minimizeWindow('${appId}')">_</div>
                        <div class="window-control window-maximize" onclick="maximizeWindow('${appId}')">□</div>
                        <div class="window-control window-close" onclick="closeWindow('${appId}')">×</div>
                    </div>
                </div>
                <div class="window-content">
                    ${content}
                </div>
                <div class="window-resizer"></div>
            `;
            
            document.body.appendChild(windowElement);
            
            // Armazenar referência da janela
            state.windows[appId] = windowElement;
            
            // Adicionar ícone na barra de tarefas
            addTaskbarIcon(appId, title);
            
            // Tornar a janela arrastável
            makeWindowDraggable(windowElement);
            
            // Tornar a janela redimensionável
            makeWindowResizable(windowElement);
            
            // Inicializar conteúdo específico do aplicativo
            initializeAppContent(appId);
        }
        
        // Adicionar ícone na barra de tarefas
        function addTaskbarIcon(appId, title) {
            const openApps = document.getElementById('open-apps');
            
            // Verificar se já existe
            const existingIcon = document.querySelector(`.taskbar-icon[data-app-id="${appId}"]`);
            if (existingIcon) {
                existingIcon.classList.add('active');
                return;
            }
            
            // Criar ícone
            const icon = document.createElement('div');
            icon.className = 'taskbar-icon active';
            icon.setAttribute('data-app-id', appId);
            icon.setAttribute('title', title);
            
            // Determinar ícone com base no appId
            let iconSrc = '';
            switch (appId) {
                case 'server-manager':
                    iconSrc = 'm.png';
                    break;
                case 'network-config':
                    iconSrc = 'ip.png';
                    break;
                case 'active-directory':
                    iconSrc = 'dire.png';
                    break;
                case 'iis-manager':
                    iconSrc = 'https://cdn-icons-png.flaticon.com/512/1927/1927656.png';
                    break;
                case 'powershell':
                    iconSrc = 'pl.png';
                    break;
                case 'explorer':
                    iconSrc = 'ex.png';
                    break;
                case 'hyper-v':
                    iconSrc = 'hv.png';
                    break;
                case 'dns-manager':
                    iconSrc = 'dns.png';
                    break;
                case 'dhcp-manager':
                    iconSrc = 'dhcp.png';
                    break;
                case 'windows-admin-center':
                    iconSrc = 'aw.png';
                    break;
                case 'group-policy':
                    iconSrc = 'policy.png';
                    break;
                case 'storage-manager':
                    iconSrc = 'ssd.png';
                    break;
                case 'chrome':
                    iconSrc = 'https://cdn-icons-png.flaticon.com/512/888/888846.png';
                    break;
                case 'edge':
                    iconSrc = 'https://cdn-icons-png.flaticon.com/512/5968/5968890.png';
                    break;
                case 'wolfguard':
                    iconSrc = 'wolf.ico';
                    break;
                case 'settings':
                    iconSrc = 'cf.png';
                    break;
                case 'firewall':
                    iconSrc = 'https://cdn-icons-png.flaticon.com/512/2625/2625815.png';
                    break;
                case 'windows-defender':
                    iconSrc = 'df.png';
                    break;
                case 'remote-desktop':
                    iconSrc = 'https://cdn-icons-png.flaticon.com/512/5289/5289039.png';
                    break;
                case 'taskschd':
                    iconSrc = 'https://cdn-icons-png.flaticon.com/512/2413/2413423.png';
                    break;
                default:
                    iconSrc = 'cf.png';
            }
            
            icon.innerHTML = `<img src="${iconSrc}" alt="${title}">`;
            
            // Adicionar evento para alternar janela
            icon.addEventListener('click', function() {
                toggleWindow(appId);
            });
            
            openApps.appendChild(icon);
        }
        
        // Alternar visibilidade da janela
        function toggleWindow(appId) {
            const window = state.windows[appId];
            if (window) {
                if (window.style.display === 'none') {
                    window.style.display = 'flex';
                    document.querySelector(`.taskbar-icon[data-app-id="${appId}"]`).classList.add('active');
                    bringToFront(window);
                } else {
                    window.style.display = 'none';
                    document.querySelector(`.taskbar-icon[data-app-id="${appId}"]`).classList.remove('active');
                }
            }
        }
        
        // Trazer janela para frente
        function bringToFront(window) {
            window.style.zIndex = ++topZIndex;
        }
        
        // Minimizar janela
        function minimizeWindow(appId) {
            const window = state.windows[appId];
            if (window) {
                window.style.display = 'none';
                document.querySelector(`.taskbar-icon[data-app-id="${appId}"]`).classList.remove('active');
            }
        }
        
        // Maximizar janela
        function maximizeWindow(appId) {
            const window = state.windows[appId];
            if (window) {
                if (window.style.width === '100%' && window.style.height === 'calc(100vh - 40px)') {
                    // Restaurar
                    window.style.width = '800px';
                    window.style.height = '600px';
                    window.style.left = '50%';
                    window.style.top = '50%';
                    window.style.transform = 'translate(-50%, -50%)';
                } else {
                    // Maximizar
                    window.style.width = '100%';
                    window.style.height = 'calc(100vh - 40px)';
                    window.style.left = '0';
                    window.style.top = '0';
                    window.style.transform = 'none';
                }
            }
        }
        
        // Fechar janela
        function closeWindow(appId) {
            const window = state.windows[appId];
            if (window) {
                window.remove();
                delete state.windows[appId];
                
                // Remover ícone da barra de tarefas
                const icon = document.querySelector(`.taskbar-icon[data-app-id="${appId}"]`);
                if (icon) {
                    icon.remove();
                }
            }
        }
        
        // Tornar a janela arrastável
        function makeWindowDraggable(windowElement) {
            const header = windowElement.querySelector('.window-header');
            
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
            header.onmousedown = dragMouseDown;
            
            function dragMouseDown(e) {
                e.preventDefault();
                bringToFront(windowElement);
                
                // Verificar se a janela está maximizada
                if (windowElement.style.width === '100%' && windowElement.style.height === 'calc(100vh - 40px)') {
                    return;
                }
                
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            }
            
            function elementDrag(e) {
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                const newTop = windowElement.offsetTop - pos2;
                const newLeft = windowElement.offsetLeft - pos1;
                
                // Verificar limites da janela
                if (newTop >= 0 && newTop + windowElement.offsetHeight <= window.innerHeight) {
                    windowElement.style.top = newTop + "px";
                }
                
                if (newLeft >= 0 && newLeft + windowElement.offsetWidth <= window.innerWidth) {
                    windowElement.style.left = newLeft + "px";
                }
                
                // Remover transformação se existir
                windowElement.style.transform = 'none';
            }
            
            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }
        
        // Tornar a janela redimensionável
        function makeWindowResizable(windowElement) {
            const resizer = windowElement.querySelector('.window-resizer');
            
            let startX, startY, startWidth, startHeight;
            
            resizer.addEventListener('mousedown', initResize);
            
            function initResize(e) {
                e.preventDefault();
                startX = e.clientX;
                startY = e.clientY;
                startWidth = parseInt(document.defaultView.getComputedStyle(windowElement).width, 10);
                startHeight = parseInt(document.defaultView.getComputedStyle(windowElement).height, 10);
                document.addEventListener('mousemove', resizeWindow);
                document.addEventListener('mouseup', stopResize);
            }
            
            function resizeWindow(e) {
                const newWidth = startWidth + e.clientX - startX;
                const newHeight = startHeight + e.clientY - startY;
                
                if (newWidth > 300) {
                    windowElement.style.width = newWidth + 'px';
                }
                
                if (newHeight > 200) {
                    windowElement.style.height = newHeight + 'px';
                }
            }
            
            function stopResize() {
                document.removeEventListener('mousemove', resizeWindow);
                document.removeEventListener('mouseup', stopResize);
            }
        }
        
        // Funções para lidar com arquivos e pastas
        function createNewFolder() {
            document.getElementById('new-folder-dialog').style.display = 'block';
            document.getElementById('new-folder-name').focus();
            document.getElementById('new-folder-name').select();
        }
        
        function closeNewFolderDialog() {
            document.getElementById('new-folder-dialog').style.display = 'none';
        }
        
        function confirmNewFolder() {
            const folderName = document.getElementById('new-folder-name').value.trim();
            if (folderName) {
                // Verificar se já existe uma pasta com esse nome
                if (state.fileSystem.desktop && state.fileSystem.desktop.some(item => item.name === folderName)) {
                    showNotification('Já existe um item com esse nome.');
                    return;
                }
                
                // Inicializar o array desktop se não existir
                if (!state.fileSystem.desktop) {
                    state.fileSystem.desktop = [];
                }
                
                // Adicionar nova pasta
                state.fileSystem.desktop.push({
                    name: folderName,
                    type: 'folder',
                    items: []
                });
                
                // Atualizar ícones do desktop
                refreshDesktopIcons();
                
                // Fechar diálogo
                closeNewFolderDialog();
                
                // Salvar estado
                saveStateToLocalStorage();
            }
        }
        
        function createNewFile() {
            document.getElementById('new-file-dialog').style.display = 'block';
            document.getElementById('new-file-name').focus();
            document.getElementById('new-file-name').select();
        }
        
        function closeNewFileDialog() {
            document.getElementById('new-file-dialog').style.display = 'none';
        }
        
        function confirmNewFile() {
            const fileName = document.getElementById('new-file-name').value.trim();
            if (fileName) {
                // Verificar se já existe um arquivo com esse nome
                if (state.fileSystem.desktop && state.fileSystem.desktop.some(item => item.name === fileName)) {
                    showNotification('Já existe um item com esse nome.');
                    return;
                }
                
                // Inicializar o array desktop se não existir
                if (!state.fileSystem.desktop) {
                    state.fileSystem.desktop = [];
                }
                
                // Adicionar novo arquivo
                state.fileSystem.desktop.push({
                    name: fileName,
                    type: 'file',
                    content: ''
                });
                
                // Atualizar ícones do desktop
                refreshDesktopIcons();
                
                // Fechar diálogo
                closeNewFileDialog();
                
                // Salvar estado
                saveStateToLocalStorage();
            }
        }
        
        function renameItem() {
            if (state.selectedItem) {
                document.getElementById('rename-dialog').style.display = 'block';
                document.getElementById('rename-input').value = state.selectedItem.name;
                document.getElementById('rename-input').focus();
                document.getElementById('rename-input').select();
            }
        }
        
        function closeRenameDialog() {
            document.getElementById('rename-dialog').style.display = 'none';
        }
        
        function confirmRename() {
            const newName = document.getElementById('rename-input').value.trim();
            if (newName && state.selectedItem) {
                // Verificar se já existe um item com esse nome
                if (state.fileSystem.desktop && state.fileSystem.desktop.some(item => item.name === newName && item !== state.selectedItem)) {
                    showNotification('Já existe um item com esse nome.');
                    return;
                }
                
                // Renomear o item
                const itemIndex = state.fileSystem.desktop.findIndex(item => item.name === state.selectedItem.name);
                if (itemIndex !== -1) {
                    state.fileSystem.desktop[itemIndex].name = newName;
                    
                    // Atualizar ícones do desktop
                    refreshDesktopIcons();
                    
                    // Fechar diálogo
                    closeRenameDialog();
                    
                    // Salvar estado
                    saveStateToLocalStorage();
                }
            }
        }
        
        function deleteItem() {
            if (state.selectedItem) {
                // Remover o item
                const itemIndex = state.fileSystem.desktop.findIndex(item => item.name === state.selectedItem.name);
                if (itemIndex !== -1) {
                    state.fileSystem.desktop.splice(itemIndex, 1);
                    
                    // Atualizar ícones do desktop
                    refreshDesktopIcons();
                    
                    // Limpar seleção
                    state.selectedItem = null;
                    
                    // Salvar estado
                    saveStateToLocalStorage();
                    
                    // Mostrar notificação
                    showNotification('Item excluído com sucesso.');
                }
            }
        }
        
        function showItemProperties() {
            if (state.selectedItem) {
                const item = state.fileSystem.desktop.find(i => i.name === state.selectedItem.name);
                if (item) {
                    // Aqui você pode criar um diálogo de propriedades, por enquanto vamos apenas mostrar uma notificação
                    showNotification(`Propriedades: ${item.name} (${item.type})`);
                }
            }
        }
        
        function openSelectedItem() {
            if (state.selectedItem) {
                if (state.selectedItem.type === 'folder') {
                    openFolder(state.selectedItem.name);
                } else if (state.selectedItem.type === 'file' && state.selectedItem.name.endsWith('.txt')) {
                    openTextFile(state.selectedItem.name);
                } else if (state.selectedItem.type === 'app') {
                    // Para aplicativos, extrair o ID do aplicativo do elemento
                    const iconElement = document.querySelector(`.desktop-icon[data-name="${state.selectedItem.name}"]`);
                    if (iconElement) {
                        const appId = iconElement.getAttribute('onclick').replace('openApp(\'', '').replace('\')', '');
                        openApp(appId);
                    }
                }
            }
        }
        
        function openFolder(folderName) {
            // Abrir o explorador de arquivos com a pasta selecionada
            openApp('explorer');
            
            // Implementação simples: apenas mostrar uma notificação
            showNotification(`Pasta aberta: ${folderName}`);
        }
        
        function openFile(fileName) {
            // Implementação simples: apenas mostrar uma notificação
            showNotification(`Arquivo aberto: ${fileName}`);
        }
        
        function openTextFile(fileName) {
            // Buscar o arquivo no desktop
            const file = state.fileSystem.desktop.find(item => item.name === fileName);
            if (file) {
                // Criar janela do editor de texto
                const windowElement = document.createElement('div');
                windowElement.className = 'window';
                windowElement.id = 'window-text-editor-' + fileName.replace(/\s+/g, '-').toLowerCase();
                windowElement.style.width = '800px';
                windowElement.style.height = '600px';
                windowElement.style.left = '50%';
                windowElement.style.top = '50%';
                windowElement.style.transform = 'translate(-50%, -50%)';
                windowElement.style.zIndex = ++topZIndex;
                
                // Estrutura da janela
                windowElement.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">Bloco de Notas - ${fileName}</div>
                        <div class="window-controls">
                            <div class="window-control window-minimize" onclick="minimizeWindow('text-editor-${fileName.replace(/\s+/g, '-').toLowerCase()}')">_</div>
                            <div class="window-control window-maximize" onclick="maximizeWindow('text-editor-${fileName.replace(/\s+/g, '-').toLowerCase()}')">□</div>
                            <div class="window-control window-close" onclick="closeTextEditor('${fileName}')">×</div>
                        </div>
                    </div>
                    <div class="window-content">
                        <div class="text-editor">
                            <div class="text-editor-toolbar">
                                <div class="toolbar-button" onclick="saveTextFile('${fileName}')">Salvar</div>
                                <div class="toolbar-button">Editar</div>
                                <div class="toolbar-button">Formatar</div>
                                <div class="toolbar-button">Visualizar</div>
                            </div>
                            <div class="text-editor-content">
                                <textarea id="text-editor-content-${fileName.replace(/\s+/g, '-').toLowerCase()}">${file.content || ''}</textarea>
                            </div>
                        </div>
                    </div>
                    <div class="window-resizer"></div>
                `;
                
                document.body.appendChild(windowElement);
                
                // Armazenar referência da janela
                state.windows['text-editor-' + fileName.replace(/\s+/g, '-').toLowerCase()] = windowElement;
                
                // Adicionar ícone na barra de tarefas
                addTaskbarIcon('text-editor-' + fileName.replace(/\s+/g, '-').toLowerCase(), 'Bloco de Notas - ' + fileName);
                
                // Tornar a janela arrastável
                makeWindowDraggable(windowElement);
                
                // Tornar a janela redimensionável
                makeWindowResizable(windowElement);
                
                // Focar no editor
                setTimeout(() => {
                    document.getElementById('text-editor-content-' + fileName.replace(/\s+/g, '-').toLowerCase()).focus();
                }, 100);
            }
        }
        
        function saveTextFile(fileName) {
            // Buscar o arquivo no desktop
            const fileIndex = state.fileSystem.desktop.findIndex(item => item.name === fileName);
            if (fileIndex !== -1) {
                // Obter o conteúdo do editor
                const content = document.getElementById('text-editor-content-' + fileName.replace(/\s+/g, '-').toLowerCase()).value;
                
                // Atualizar o conteúdo do arquivo
                state.fileSystem.desktop[fileIndex].content = content;
                
                // Salvar estado
                saveStateToLocalStorage();
                
                // Mostrar notificação
                showNotification(`Arquivo ${fileName} salvo com sucesso.`);
            }
        }
        
        function closeTextEditor(fileName) {
            // Perguntar se deseja salvar antes de fechar (simplificado)
            const saveFirst = confirm('Deseja salvar as alterações antes de fechar?');
            if (saveFirst) {
                saveTextFile(fileName);
            }
            
            // Fechar a janela
            closeWindow('text-editor-' + fileName.replace(/\s+/g, '-').toLowerCase());
        }
        
        // Funções para controle do sistema
        function refreshDesktop() {
            // Atualizar ícones do desktop
            refreshDesktopIcons();
            
            // Mostrar notificação
            showNotification('Área de trabalho atualizada');
        }
        
        function openDisplaySettings() {
            // Abrir configurações de exibição
            openApp('settings');
            
            // Mostrar notificação
            showNotification('Configurações de exibição abertas');
        }
        
        function lockComputer() {
            // Esconder opções de energia
            document.getElementById('power-options').style.display = 'none';
            
            // Mostrar tela de bloqueio
            document.getElementById('lock-screen').style.display = 'flex';
            document.getElementById('lock-screen-message').textContent = 'Computador bloqueado';
            document.getElementById('lock-screen-button').textContent = 'Desbloquear';
            document.getElementById('lock-screen-button').onclick = unlockComputer;
        }
        
        function unlockComputer() {
            // Esconder tela de bloqueio
            document.getElementById('lock-screen').style.display = 'none';
        }
        
        function restartComputer() {
            // Esconder opções de energia
            document.getElementById('power-options').style.display = 'none';
            
            // Mostrar tela de bloqueio com mensagem de reinicialização
            document.getElementById('lock-screen').style.display = 'flex';
            document.getElementById('lock-screen-message').textContent = 'Reiniciando...';
            document.getElementById('lock-screen-button').style.display = 'none';
            
            // Simular reinicialização após alguns segundos
            setTimeout(() => {
                // Recarregar a página
                window.location.reload();
            }, 3000);
        }
        
        function shutdownComputer() {
            // Esconder opções de energia
            document.getElementById('power-options').style.display = 'none';
            
            // Mostrar tela de bloqueio com mensagem de desligamento
            document.getElementById('lock-screen').style.display = 'flex';
            document.getElementById('lock-screen-message').textContent = 'Desligando...';
            document.getElementById('lock-screen-button').style.display = 'none';
            
            // Simular desligamento após alguns segundos
            setTimeout(() => {
                // Mostrar mensagem final
                document.getElementById('lock-screen-message').textContent = 'Desligado. Clique para ligar novamente.';
                document.getElementById('lock-screen-button').style.display = 'block';
                document.getElementById('lock-screen-button').textContent = 'Ligar';
                document.getElementById('lock-screen-button').onclick = () => window.location.reload();
            }, 3000);
        }
        
        function openSecurityCenter() {
            openApp('wolfguard');
        }
        
        function openNetworkSettings() {
            openApp('network-config');
        }
        
        function openUpdateSettings() {
            openApp('settings');
            
            // Selecionar a categoria de atualizações (a ser implementado)
            // Por enquanto, apenas mostrar uma notificação
            showNotification('Configurações de atualização abertas');
        }
        
        // Funções para criar conteúdo das aplicações
        function createServerManagerContent() {
            return `
                <div class="server-manager">
                    <div class="sidebar">
                        <div class="sidebar-item active" onclick="switchServerManagerPanel('dashboard')">Dashboard</div>
                        <div class="sidebar-item" onclick="switchServerManagerPanel('local-server')">Local Server</div>
                        <div class="sidebar-item" onclick="switchServerManagerPanel('all-servers')">All Servers</div>
                        <div class="sidebar-item" onclick="switchServerManagerPanel('file-services')">File Services</div>
                        <div class="sidebar-item" onclick="switchServerManagerPanel('storage-services')">Storage Services</div>
                        <div class="sidebar-item" onclick="switchServerManagerPanel('compute')">Compute</div>
                        <div class="sidebar-item" onclick="switchServerManagerPanel('networking')">Networking</div>
                        <div class="sidebar-item" onclick="switchServerManagerPanel('remote-access')">Remote Access</div>
                    </div>
                    <div class="content-panel">
                        <div id="dashboard-panel" class="dashboard">
                            <div class="dashboard-card">
                                <div class="dashboard-card-title">Sistema Operacional</div>
                                <div class="dashboard-card-content">
                                    <p>Windows Server 2025 Standard</p>
                                    <p>Compilação 25000.1000</p>
                                    <p>Último boot: Hoje, 08:45</p>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="dashboard-card-title">CPU</div>
                                <div class="dashboard-card-content">
                                    <p>Intel Xeon E5-2678 v3 @ 2.50GHz</p>
                                    <p>12 núcleos, 24 threads</p>
                                    <p>Utilização: 23%</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 23%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="dashboard-card-title">Memória</div>
                                <div class="dashboard-card-content">
                                    <p>32GB DDR4 ECC</p>
                                    <p>Em uso: 8.4 GB (26%)</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 26%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="dashboard-card-title">Armazenamento</div>
                                <div class="dashboard-card-content">
                                    <p>C: 120 GB de 500 GB (24%)</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 24%"></div>
                                    </div>
                                    <p>D: 350 GB de 1000 GB (35%)</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 35%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="dashboard-card-title">Rede</div>
                                <div class="dashboard-card-content">
                                    <p>Ethernet: ${state.ipConfig.ipAddress}</p>
                                    <p>Upload: 0.5 Mbps</p>
                                    <p>Download: 2.3 Mbps</p>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="dashboard-card-title">Serviços em Execução</div>
                                <div class="dashboard-card-content">
                                    <p>Active Directory: Iniciado</p>
                                    <p>DNS Server: Iniciado</p>
                                    <p>IIS: Iniciado</p>
                                    <p>SQL Server: Parado</p>
                                </div>
                            </div>
                        </div>
                        <div id="local-server-panel" style="display: none;">
                            <h2 style="margin-bottom: 20px;">Propriedades do Servidor Local</h2>
                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                <div>Nome do Computador:</div>
                                <div><strong>${state.computerName}</strong> <button class="btn btn-secondary" style="padding: 2px 5px; margin-left: 5px;" onclick="openComputerNameDialog()">Alterar</button></div>
                                
                                <div>Grupo de Trabalho:</div>
                                <div><strong>WORKGROUP</strong></div>
                                
                                <div>Windows Firewall:</div>
                                <div><strong>${state.settings.firewall ? 'Ativado' : 'Desativado'}</strong></div>
                                
                                <div>Windows Update:</div>
                                <div><strong>Últimas atualizações instaladas em 05/06/2025</strong></div>
                                
                                <div>Hora do Servidor:</div>
                                <div><strong id="server-time">10:30:45</strong></div>
                                
                                <div>Fuso Horário:</div>
                                <div><strong>UTC-3 Brasília</strong></div>
                                
                                <div>IE Enhanced Security:</div>
                                <div><strong>Ativado</strong> <button class="btn btn-secondary" style="padding: 2px 5px; margin-left: 5px;">Desativar</button></div>
                                
                                <div>Último Boot:</div>
                                <div><strong>10/06/2025 08:45</strong></div>
                                
                                <div>Endereço IP:</div>
                                <div>
                                    <strong>${state.ipConfig.ipAddress}</strong> 
                                    <button class="btn btn-secondary" style="padding: 2px 5px; margin-left: 5px;" onclick="openApp('network-config')">Configurar</button>
                                </div>
                                
                                <div>Roles e Features:</div>
                                <div>
                                    <strong>DNS Server, File Services, Web Server (IIS)</strong> 
                                    <button class="btn btn-secondary" style="padding: 2px 5px; margin-left: 5px;">Gerenciar</button>
                                </div>
                                
                                <div>Performance:</div>
                                <div>
                                    <strong>CPU: 23%, Memória: 26%, Disco: 5%</strong> 
                                    <button class="btn btn-secondary" style="padding: 2px 5px; margin-left: 5px;">Monitorar</button>
                                </div>
                            </div>
                        </div>
                        <div id="all-servers-panel" style="display: none;">
                            <h2 style="margin-bottom: 20px;">Todos os Servidores</h2>
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome do Servidor</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Endereço IP</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Status</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Roles</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">WIN-SRV2025</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.100</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: green;">Online</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">DNS, AD DS, File Services, Web Server</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">SQL-SERVER</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.101</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: green;">Online</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">SQL Server</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">EXCHANGE-SRV</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.102</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: red;">Offline</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Exchange Server</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">FILESERVER</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.103</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: green;">Online</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">File Services, DFS</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createNetworkConfigContent() {
            return `
                <div class="network-config">
                    <h2>Configuração de Interface de Rede</h2>
                    <p style="margin-bottom: 20px;">Configure as propriedades da interface de rede.</p>
                    
                    <div class="form-group">
                        <label for="interface-select">Interface:</label>
                        <select id="interface-select">
                            <option>Ethernet (Intel(R) I350 Gigabit Network Connection)</option>
                            <option>Wi-Fi (Intel(R) Wireless-AC 9560)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Estado:</label>
                        <div style="display: flex; align-items: center;">
                            <span style="color: green; margin-right: 10px;">●</span> Conectado
                            <button class="btn btn-secondary" style="margin-left: 10px; padding: 3px 8px;">Desativar</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="dhcp-toggle">Configuração:</label>
                        <div>
                            <input type="radio" id="dhcp-radio" name="ip-config" ${state.ipConfig.dhcpEnabled ? 'checked' : ''} onchange="toggleDHCP(true)">
                            <label for="dhcp-radio">Obter endereço IP automaticamente (DHCP)</label>
                        </div>
                        <div>
                            <input type="radio" id="static-radio" name="ip-config" ${!state.ipConfig.dhcpEnabled ? 'checked' : ''} onchange="toggleDHCP(false)">
                            <label for="static-radio">Usar o seguinte endereço IP:</label>
                        </div>
                    </div>
                    
                    <div id="static-ip-config" style="margin-left: 20px; ${state.ipConfig.dhcpEnabled ? 'opacity: 0.5;' : ''}">
                        <div class="form-group">
                            <label for="ip-address">Endereço IP:</label>
                            <input type="text" id="ip-address" value="${state.ipConfig.ipAddress}" ${state.ipConfig.dhcpEnabled ? 'disabled' : ''}>
                        </div>
                        
                        <div class="form-group">
                            <label for="subnet-mask">Máscara de sub-rede:</label>
                            <input type="text" id="subnet-mask" value="${state.ipConfig.subnetMask}" ${state.ipConfig.dhcpEnabled ? 'disabled' : ''}>
                        </div>
                        
                        <div class="form-group">
                            <label for="default-gateway">Gateway padrão:</label>
                            <input type="text" id="default-gateway" value="${state.ipConfig.gateway}" ${state.ipConfig.dhcpEnabled ? 'disabled' : ''}>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div>
                            <input type="radio" id="dns-auto" name="dns-config" ${state.ipConfig.dhcpEnabled ? 'checked' : ''} onchange="toggleDNS(true)">
                            <label for="dns-auto">Obter endereço de servidor DNS automaticamente</label>
                        </div>
                        <div>
                            <input type="radio" id="dns-manual" name="dns-config" ${!state.ipConfig.dhcpEnabled ? 'checked' : ''} onchange="toggleDNS(false)">
                            <label for="dns-manual">Usar os seguintes endereços de servidor DNS:</label>
                        </div>
                    </div>
                    
                    <div id="manual-dns-config" style="margin-left: 20px; ${state.ipConfig.dhcpEnabled ? 'opacity: 0.5;' : ''}">
                        <div class="form-group">
                            <label for="preferred-dns">Servidor DNS preferencial:</label>
                            <input type="text" id="preferred-dns" value="${state.ipConfig.dns1}" ${state.ipConfig.dhcpEnabled ? 'disabled' : ''}>
                        </div>
                        
                        <div class="form-group">
                            <label for="alternate-dns">Servidor DNS alternativo:</label>
                            <input type="text" id="alternate-dns" value="${state.ipConfig.dns2}" ${state.ipConfig.dhcpEnabled ? 'disabled' : ''}>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Configurações avançadas:</label>
                        <button class="btn btn-secondary">Configurar TCP/IP avançado</button>
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="cancelNetworkConfig()">Cancelar</button>
                        <button class="btn btn-primary" onclick="saveNetworkConfig()">Salvar</button>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <h3>Status da Conexão</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                <div>Duração da Conexão:</div>
                                <div>1 hora, 28 minutos</div>
                                
                                <div>Velocidade:</div>
                                <div>1.0 Gbps</div>
                                
                                <div>Bytes enviados:</div>
                                <div>23.8 MB</div>
                                
                                <div>Bytes recebidos:</div>
                                <div>56.2 MB</div>
                                
                                <div>Endereço MAC:</div>
                                <div>00-1A-2B-3C-4D-5E</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <h3>Firewall de Rede</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                            <div class="settings-option">
                                <div class="settings-option-info">
                                    <div class="settings-option-title">Firewall de Rede do Windows</div>
                                    <div class="settings-option-description">Protege seu computador contra ameaças de rede</div>
                                </div>
                                <div class="settings-toggle ${state.settings.firewall ? 'active' : ''}" onclick="toggleFirewall()"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createActiveDirectoryContent() {
            let userList = '';
            for (const user of state.activeDirectory.users) {
                userList += `
                    <div class="user-item">
                        <img src="https://cdn-icons-png.flaticon.com/512/${user.type === 'User' ? '456/456212' : '681/681494'}.png" class="user-icon">
                        <span>${user.name}</span>
                        <span style="margin-left: auto; color: ${user.enabled ? 'green' : 'red'}">${user.enabled ? 'Ativado' : 'Desativado'}</span>
                    </div>
                `;
            }
            
            return `
                <div style="padding: 15px;">
                    <h2>Active Directory Users and Computers</h2>
                    <p style="margin-bottom: 20px;">Gerencie usuários e computadores do domínio ${state.activeDirectory.domain}</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Novo Usuário</button>
                            <button class="btn btn-primary" style="margin-right: 5px;">Novo Grupo</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 400px;">
                        <div style="width: 250px; border: 1px solid #ddd; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Floresta: ${state.activeDirectory.domain}</div>
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="padding: 5px; cursor: pointer;">Domain Controllers</li>
                                <li style="padding: 5px; cursor: pointer; background-color: #e0e0e0;">Users</li>
                                <li style="padding: 5px; cursor: pointer;">Computers</li>
                                <li style="padding: 5px; cursor: pointer;">Builtin</li>
                                <li style="padding: 5px; cursor: pointer;">ForeignSecurityPrincipals</li>
                                <li style="padding: 5px; cursor: pointer;">Managed Service Accounts</li>
                            </ul>
                        </div>
                        
                        <div style="flex-grow: 1; border: 1px solid #ddd; border-left: none; padding: 10px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Usuários e Grupos</div>
                            <div class="ad-users">
                                ${userList}
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Propriedades do Domínio</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                <div>Nome do Domínio:</div>
                                <div>${state.activeDirectory.domain}</div>
                                
                                <div>Nível Funcional da Floresta:</div>
                                <div>${state.activeDirectory.forestLevel}</div>
                                
                                <div>Nível Funcional do Domínio:</div>
                                <div>${state.activeDirectory.domainLevel}</div>
                                
                                <div>Controladores de Domínio:</div>
                                <div>1</div>
                                
                                <div>Modo DSRM:</div>
                                <div>Desativado</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createIISManagerContent() {
            let siteList = '';
            for (const site of state.iis.sites) {
                siteList += `
                    <div class="site-item">
                        <div class="site-status status-${site.status}"></div>
                        <span>${site.name}</span>
                        <span style="margin-left: auto;">${site.bindings}</span>
                    </div>
                `;
            }
            
            return `
                <div style="padding: 15px;">
                    <h2>Internet Information Services (IIS) Manager</h2>
                    <p style="margin-bottom: 20px;">Gerencie sites, aplicativos e configurações do servidor web.</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Adicionar Site</button>
                            <button class="btn btn-primary" style="margin-right: 5px;">Adicionar Aplicativo</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 400px;">
                        <div style="width: 250px; border: 1px solid #ddd; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Conexões</div>
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="padding: 5px; cursor: pointer; background-color: #e0e0e0;">WIN-SRV2025</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">Application Pools</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">Sites</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Default Web Site</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Intranet</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">API Service</li>
                            </ul>
                        </div>
                        
                        <div style="flex-grow: 1; border: 1px solid #ddd; border-left: none; padding: 10px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Sites</div>
                            <div class="site-list">
                                ${siteList}
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <h3>Ações</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                        <button class="btn btn-secondary">Iniciar</button>
                                        <button class="btn btn-secondary">Parar</button>
                                        <button class="btn btn-secondary">Reiniciar</button>
                                        <button class="btn btn-secondary">Editar Permissões</button>
                                        <button class="btn btn-secondary">Editar Bindings</button>
                                        <button class="btn btn-secondary">Explorar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Recursos do Servidor</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                <div style="text-align: center; cursor: pointer; padding: 10px;">
                                    <img src="https://cdn-icons-png.flaticon.com/512/476/476700.png" style="width: 24px; height: 24px; margin-bottom: 5px;">
                                    <div>Certificados SSL</div>
                                </div>
                                <div style="text-align: center; cursor: pointer; padding: 10px;">
                                    <img src="https://cdn-icons-png.flaticon.com/512/2906/2906274.png" style="width: 24px; height: 24px; margin-bottom: 5px;">
                                    <div>Cache HTTP</div>
                                </div>
                                <div style="text-align: center; cursor: pointer; padding: 10px;">
                                    <img src="https://cdn-icons-png.flaticon.com/512/1063/1063809.png" style="width: 24px; height: 24px; margin-bottom: 5px;">
                                    <div>Regras de Reescrita</div>
                                </div>
                                <div style="text-align: center; cursor: pointer; padding: 10px;">
                                    <img src="cf.png" style="width: 24px; height: 24px; margin-bottom: 5px;">
                                    <div>Configuração</div>
                                </div>
                                <div style="text-align: center; cursor: pointer; padding: 10px;">
                                    <img src="https://cdn-icons-png.flaticon.com/512/2821/2821739.png" style="width: 24px; height: 24px; margin-bottom: 5px;">
                                    <div>Logs</div>
                                </div>
                                <div style="text-align: center; cursor: pointer; padding: 10px;">
                                    <img src="https://cdn-icons-png.flaticon.com/512/456/456212.png" style="width: 24px; height: 24px; margin-bottom: 5px;">
                                    <div>Autenticação</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createPowerShellContent() {
            return `
                <div class="console">
                    <div id="powershell-output">
                        Windows PowerShell
                        Copyright (C) Microsoft Corporation. Todos os direitos reservados.
                        
                        Windows PowerShell com Trusted Command Execution
                        
                        PS C:\\Users\\Administrator> _
                    </div>
                    <div class="console-input">
                        <span class="console-prompt">PS C:\\Users\\Administrator></span>
                        <input type="text" class="console-command" id="powershell-command" onkeydown="handlePowerShellCommand(event)">
                    </div>
                </div>
            `;
        }
        
        function createExplorerContent() {
            return `
                <div class="explorer">
                    <div class="explorer-toolbar">
                        <div class="toolbar-button" onclick="createNewFolderInExplorer()">Nova Pasta</div>
                        <div class="toolbar-button" onclick="createNewFileInExplorer()">Novo Arquivo</div>
                        <div class="toolbar-button">Cortar</div>
                        <div class="toolbar-button">Copiar</div>
                        <div class="toolbar-button">Colar</div>
                        <div class="toolbar-button">Excluir</div>
                        <div class="toolbar-button">Renomear</div>
                        <div class="toolbar-button">Propriedades</div>
                    </div>
                    <div class="address-bar">
                        <input type="text" value="Desktop" id="explorer-address">
                    </div>
                    <div style="display: flex; flex-grow: 1; overflow: hidden;">
                        <div class="folder-tree">
                            <div class="folder-item">
                                <img src="https://cdn-icons-png.flaticon.com/512/1946/1946488.png">
                                <span>Este Computador</span>
                            </div>
                            <div class="folder-item" style="padding-left: 20px;">
                                <img src="ssd.png">
                                <span>Disco Local (C:)</span>
                            </div>
                            <div class="folder-item" style="padding-left: 35px;">
                                <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
                                <span>Windows</span>
                            </div>
                            <div class="folder-item" style="padding-left: 35px;">
                                <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
                                <span>Program Files</span>
                            </div>
                            <div class="folder-item" style="padding-left: 35px;">
                                <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
                                <span>Users</span>
                            </div>
                            <div class="folder-item" style="padding-left: 20px;">
                                <img src="ssd.png">
                                <span>Disco Local (D:)</span>
                            </div>
                            <div class="folder-item" style="padding-left: 20px;">
                                <img src="ssd.png">
                                <span>Disco Local (E:)</span>
                            </div>
                            <div class="folder-item" style="background-color: #e0e0e0;">
                                <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png">
                                <span>Desktop</span>
                            </div>
                        </div>
                        <div class="file-list">
                            <div class="file-grid" id="explorer-file-grid">
                                <!-- Os itens serão adicionados dinamicamente -->
                            </div>
                        </div>
                    </div>
                    <div style="padding: 5px; background-color: #f5f5f5; border-top: 1px solid #ddd;">
                        <span id="explorer-status">0 itens</span>
                    </div>
                </div>
            `;
        }
        
        function createBrowserContent(browserType) {
            const iconSrc = browserType === 'chrome' 
                ? 'https://cdn-icons-png.flaticon.com/512/888/888846.png' 
                : 'https://cdn-icons-png.flaticon.com/512/5968/5968890.png';
            
            const browserTitle = browserType === 'chrome' ? 'Google Chrome' : 'Microsoft Edge';
            
            const startPage = browserType === 'chrome' 
                ? 'https://www.google.com' 
                : 'https://www.bing.com';
            
            return `
                <div class="browser">
                    <div class="browser-toolbar">
                        <div class="browser-button" onclick="browserBack('${browserType}')">
                            <img src="https://cdn-icons-png.flaticon.com/512/271/271220.png" style="width: 16px; height: 16px;">
                        </div>
                        <div class="browser-button" onclick="browserForward('${browserType}')">
                            <img src="https://cdn-icons-png.flaticon.com/512/271/271228.png" style="width: 16px; height: 16px;">
                        </div>
                        <div class="browser-button" onclick="browserRefresh('${browserType}')">
                            <img src="https://cdn-icons-png.flaticon.com/512/61/61444.png" style="width: 16px; height: 16px;">
                        </div>
                        <div class="browser-address">
                            <img src="${iconSrc}" style="width: 16px; height: 16px; margin-right: 8px;">
                            <input type="text" id="${browserType}-address" value="${startPage}" onkeydown="browserNavigate(event, '${browserType}')">
                        </div>
                    </div>
                    <div class="browser-content">
                        <iframe id="${browserType}-iframe" class="browser-iframe" src="${startPage}"></iframe>
                    </div>
                </div>
            `;
        }
        
        function createWolfGuardContent() {
            const isProtected = state.settings.wolfGuardFeatures.realTimeScan && 
                              state.settings.wolfGuardFeatures.webProtection && 
                              state.settings.wolfGuardFeatures.firewall;
            
            return `
                <div class="antivirus">
                    <div class="antivirus-header">
                        <div class="antivirus-title">WolfGuard Antivírus</div>
                        <div class="antivirus-subtitle">Proteção avançada para seu servidor</div>
                    </div>
                    
                    <div class="antivirus-status">
                        <div class="status-circle ${isProtected ? 'status-protected' : 'status-alert'}">
                            ${isProtected ? '✓' : '!'}
                        </div>
                        <h2>${isProtected ? 'Protegido' : 'Atenção Necessária'}</h2>
                        <p>${isProtected ? 'Seu servidor está protegido contra ameaças.' : 'Algumas proteções estão desativadas.'}</p>
                    </div>
                    
                    <div class="antivirus-features">
                        <div class="antivirus-feature">
                            <div class="feature-header">
                                <img src="https://cdn-icons-png.flaticon.com/512/4224/4224881.png" class="feature-icon">
                                <div class="feature-title">Proteção em Tempo Real</div>
                                <div class="feature-status ${state.settings.wolfGuardFeatures.realTimeScan ? 'active' : ''}" onclick="toggleWolfGuardFeature('realTimeScan')"></div>
                            </div>
                            <div class="feature-description">Monitora e bloqueia ameaças em tempo real</div>
                        </div>
                        
                        <div class="antivirus-feature">
                            <div class="feature-header">
                                <img src="https://cdn-icons-png.flaticon.com/512/1006/1006771.png" class="feature-icon">
                                <div class="feature-title">Proteção Web</div>
                                <div class="feature-status ${state.settings.wolfGuardFeatures.webProtection ? 'active' : ''}" onclick="toggleWolfGuardFeature('webProtection')"></div>
                            </div>
                            <div class="feature-description">Bloqueia sites maliciosos e downloads perigosos</div>
                        </div>
                        
                        <div class="antivirus-feature">
                            <div class="feature-header">
                                <img src="https://cdn-icons-png.flaticon.com/512/2625/2625815.png" class="feature-icon">
                                <div class="feature-title">Firewall</div>
                                <div class="feature-status ${state.settings.wolfGuardFeatures.firewall ? 'active' : ''}" onclick="toggleWolfGuardFeature('firewall')"></div>
                            </div>
                            <div class="feature-description">Controla o tráfego de rede e bloqueia intrusões</div>
                        </div>
                        
                        <div class="antivirus-feature">
                            <div class="feature-header">
                                <img src="https://cdn-icons-png.flaticon.com/512/2665/2665038.png" class="feature-icon">
                                <div class="feature-title">Proteção contra Ransomware</div>
                                <div class="feature-status ${state.settings.wolfGuardFeatures.ransomwareProtection ? 'active' : ''}" onclick="toggleWolfGuardFeature('ransomwareProtection')"></div>
                            </div>
                            <div class="feature-description">Protege arquivos importantes contra criptografia maliciosa</div>
                        </div>
                        
                        <div class="antivirus-feature" onclick="performScan()">
                            <div class="feature-header">
                                <img src="https://cdn-icons-png.flaticon.com/512/3523/3523314.png" class="feature-icon">
                                <div class="feature-title">Verificar Agora</div>
                            </div>
                            <div class="feature-description">Iniciar uma verificação completa do sistema</div>
                        </div>
                        
                        <div class="antivirus-feature" onclick="updateWolfGuard()">
                            <div class="feature-header">
                                <img src="https://cdn-icons-png.flaticon.com/512/686/686344.png" class="feature-icon">
                                <div class="feature-title">Atualizar</div>
                            </div>
                            <div class="feature-description">Atualizar definições de vírus e mecanismo de proteção</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createSettingsContent() {
            return `
                <div class="settings">
                    <div class="settings-sidebar">
                        <div class="settings-category active" onclick="switchSettingsCategory('system')">
                            <img src="cf.png">
                            <span>Sistema</span>
                        </div>
                        <div class="settings-category" onclick="switchSettingsCategory('personalization')">
                            <img src="https://cdn-icons-png.flaticon.com/512/3281/3281303.png">
                            <span>Personalização</span>
                        </div>
                        <div class="settings-category" onclick="switchSettingsCategory('network')">
                            <img src="https://cdn-icons-png.flaticon.com/512/2099/2099193.png">
                            <span>Rede e Internet</span>
                        </div>
                        <div class="settings-category" onclick="switchSettingsCategory('security')">
                            <img src="https://cdn-icons-png.flaticon.com/512/2625/2625815.png">
                            <span>Segurança</span>
                        </div>
                        <div class="settings-category" onclick="switchSettingsCategory('updates')">
                            <img src="https://cdn-icons-png.flaticon.com/512/686/686344.png">
                            <span>Atualizações</span>
                        </div>
                        <div class="settings-category" onclick="switchSettingsCategory('about')">
                            <img src="https://cdn-icons-png.flaticon.com/512/471/471664.png">
                            <span>Sobre</span>
                        </div>
                    </div>
                    
                    <div class="settings-content">
                        <div id="system-settings" class="settings-panel active">
                            <h2>Configurações do Sistema</h2>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Informações do Sistema</div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Nome do Dispositivo:</div>
                                        <div><strong>${state.computerName}</strong></div>
                                        
                                        <div>Sistema Operacional:</div>
                                        <div><strong>Windows Server 2025 Standard</strong></div>
                                        
                                        <div>Processador:</div>
                                        <div><strong>Intel Xeon E5-2678 v3 @ 2.50GHz</strong></div>
                                        
                                        <div>Memória RAM:</div>
                                        <div><strong>32 GB</strong></div>
                                        
                                        <div>ID do Produto:</div>
                                        <div><strong>00123-45678-90123-ABCDE</strong></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Armazenamento</div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Disco C:</div>
                                        <div><strong>380 GB livres de 500 GB</strong></div>
                                        
                                        <div>Disco D:</div>
                                        <div><strong>650 GB livres de 1000 GB</strong></div>
                                        
                                        <div>Disco E:</div>
                                        <div><strong>1200 GB livres de 2000 GB</strong></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Energia</div>
                                <div class="settings-option">
                                    <div class="settings-option-info">
                                        <div class="settings-option-title">Modo de Economia de Energia</div>
                                        <div class="settings-option-description">Reduz o consumo de energia quando o servidor está ocioso</div>
                                    </div>
                                    <div class="settings-toggle" onclick="toggleSetting(this)"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="personalization-settings" class="settings-panel">
                            <h2>Personalização</h2>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Plano de Fundo</div>
                                <div>Escolha um papel de parede para sua área de trabalho:</div>
                                <div class="wallpaper-options">
                                    <div class="wallpaper-option ${state.settings.wallpaper === 1 ? 'active' : ''}" style="background-image: url('https://source.unsplash.com/random/1920x1080/?server,datacenter')" onclick="applyWallpaperFromSettings(1)"></div>
                                    <div class="wallpaper-option ${state.settings.wallpaper === 2 ? 'active' : ''}" style="background-image: url('https://source.unsplash.com/random/1920x1080/?technology')" onclick="applyWallpaperFromSettings(2)"></div>
                                    <div class="wallpaper-option ${state.settings.wallpaper === 3 ? 'active' : ''}" style="background-image: url('https://source.unsplash.com/random/1920x1080/?nature')" onclick="applyWallpaperFromSettings(3)"></div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Cores</div>
                                <div style="margin-bottom: 15px;">Cor de destaque:</div>
                                <input type="color" id="settings-accent-color" value="${state.settings.accentColor}" onchange="updateAccentColor(this.value)">
                            </div>
                        </div>
                        
                        <div id="network-settings" class="settings-panel">
                            <h2>Rede e Internet</h2>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Status</div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Conexão:</div>
                                        <div><strong>Ethernet, conectado</strong></div>
                                        
                                        <div>Endereço IP:</div>
                                        <div><strong>${state.ipConfig.ipAddress}</strong></div>
                                        
                                        <div>Gateway:</div>
                                        <div><strong>${state.ipConfig.gateway}</strong></div>
                                        
                                        <div>DNS:</div>
                                        <div><strong>${state.ipConfig.dns1}, ${state.ipConfig.dns2}</strong></div>
                                    </div>
                                </div>
                                <button class="btn btn-primary" onclick="openApp('network-config')">Configurações de Rede</button>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Firewall de Rede</div>
                                <div class="settings-option">
                                    <div class="settings-option-info">
                                        <div class="settings-option-title">Firewall de Rede do Windows</div>
                                        <div class="settings-option-description">Protege seu computador contra ameaças de rede</div>
                                    </div>
                                    <div class="settings-toggle ${state.settings.firewall ? 'active' : ''}" onclick="toggleFirewall()"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="security-settings" class="settings-panel">
                            <h2>Segurança</h2>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Proteção contra Vírus e Ameaças</div>
                                <div class="settings-option">
                                    <div class="settings-option-info">
                                        <div class="settings-option-title">Proteção em Tempo Real</div>
                                        <div class="settings-option-description">Monitora o sistema constantemente para detectar ameaças</div>
                                    </div>
                                    <div class="settings-toggle ${state.settings.antivirus ? 'active' : ''}" onclick="toggleAntivirus()"></div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <button class="btn btn-primary" onclick="openApp('wolfguard')">Abrir WolfGuard Antivírus</button>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Proteção Avançada</div>
                                <div class="settings-option">
                                    <div class="settings-option-info">
                                        <div class="settings-option-title">SmartScreen</div>
                                        <div class="settings-option-description">Verifica aplicativos e arquivos baixados</div>
                                    </div>
                                    <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="updates-settings" class="settings-panel">
                            <h2>Windows Update</h2>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Configurações de Atualização</div>
                                <div class="settings-option">
                                    <div class="settings-option-info">
                                        <div class="settings-option-title">Atualizações Automáticas</div>
                                        <div class="settings-option-description">Baixar e instalar atualizações automaticamente</div>
                                    </div>
                                    <div class="settings-toggle ${state.settings.autoUpdate ? 'active' : ''}" onclick="toggleAutoUpdate()"></div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Status das Atualizações</div>
                                <div style="margin-bottom: 20px;">
                                    <p>Você está com o Windows atualizado.</p>
                                    <p>Última verificação: Hoje às 08:30</p>
                                    <p>Última atualização instalada: 05/06/2025</p>
                                </div>
                                <button class="btn btn-primary">Verificar Atualizações</button>
                            </div>
                        </div>
                        
                        <div id="about-settings" class="settings-panel">
                            <h2>Sobre</h2>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Windows Server</div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Edição:</div>
                                        <div><strong>Windows Server 2025 Standard</strong></div>
                                        
                                        <div>Versão:</div>
                                        <div><strong>25000.1000</strong></div>
                                        
                                        <div>Instalado em:</div>
                                        <div><strong>05/06/2025</strong></div>
                                        
                                        <div>Sistema operacional:</div>
                                        <div><strong>64 bits, x64</strong></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="settings-section">
                                <div class="settings-section-title">Especificações</div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Processador:</div>
                                        <div><strong>Intel Xeon E5-2678 v3 @ 2.50GHz, 12 núcleos, 24 threads</strong></div>
                                        
                                        <div>Memória RAM:</div>
                                        <div><strong>32 GB DDR4 ECC</strong></div>
                                        
                                        <div>Placa de vídeo:</div>
                                        <div><strong>Adaptador Microsoft Basic Display</strong></div>
                                        
                                        <div>Rede:</div>
                                        <div><strong>Intel I350 Gigabit Network Connection</strong></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createFirewallContent() {
            return `
                <div class="firewall-panel">
                    <div class="firewall-header">
                        <img src="https://cdn-icons-png.flaticon.com/512/2625/2625815.png" alt="Firewall">
                        <div class="firewall-header-text">
                            <h2>Windows Defender Firewall</h2>
                            <p>Proteja seu servidor contra ameaças externas e intrusões de rede</p>
                        </div>
                    </div>
                    
                    <div class="firewall-status">
                        <img src="https://cdn-icons-png.flaticon.com/512/2625/2625815.png" alt="Firewall" class="firewall-status-icon">
                        <div class="firewall-status-text">
                            <h3>${state.settings.firewall ? 'O Windows Defender Firewall está ativado' : 'O Windows Defender Firewall está desativado'}</h3>
                            <p>${state.settings.firewall ? 'Seu servidor está protegido contra ameaças de rede' : 'Seu servidor está vulnerável a ameaças de rede'}</p>
                            <button class="btn ${state.settings.firewall ? 'btn-secondary' : 'btn-primary'}" onclick="toggleFirewall()">${state.settings.firewall ? 'Desativar Firewall' : 'Ativar Firewall'}</button>
                        </div>
                    </div>
                    
                    <div class="firewall-profiles">
                        <h3 style="margin-bottom: 15px;">Perfis de Rede</h3>
                        <div class="profile-item">
                            <div class="profile-name">Rede de Domínio</div>
                            <div class="profile-status">${state.settings.firewall ? 'Ativo' : 'Inativo'}</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-name">Rede Privada</div>
                            <div class="profile-status">${state.settings.firewall ? 'Ativo' : 'Inativo'}</div>
                        </div>
                        <div class="profile-item">
                            <div class="profile-name">Rede Pública</div>
                            <div class="profile-status">${state.settings.firewall ? 'Ativo' : 'Inativo'}</div>
                        </div>
                    </div>
                    
                    <div class="firewall-actions">
                        <div class="firewall-action" onclick="showFirewallRules()">
                            <img src="https://cdn-icons-png.flaticon.com/512/2099/2099058.png" alt="Rules">
                            <div>Regras de Entrada/Saída</div>
                        </div>
                        <div class="firewall-action" onclick="showFirewallLogs()">
                            <img src="https://cdn-icons-png.flaticon.com/512/2821/2821739.png" alt="Logs">
                            <div>Logs do Firewall</div>
                        </div>
                        <div class="firewall-action" onclick="showFirewallAdvanced()">
                            <img src="cf.png" alt="Advanced">
                            <div>Configurações Avançadas</div>
                        </div>
                        <div class="firewall-action" onclick="restoreFirewallDefaults()">
                            <img src="https://cdn-icons-png.flaticon.com/512/126/126502.png" alt="Reset">
                            <div>Restaurar Padrões</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Regras Recentes</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                            <thead>
                                <tr style="background-color: #f0f0f0;">
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Direção</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Perfis</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Habilitada</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Ação</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Remote Desktop (TCP-In)</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Entrada</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Domínio, Privado</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Sim</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Permitir</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">File and Printer Sharing (SMB-In)</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Entrada</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Domínio, Privado</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Sim</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Permitir</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">World Wide Web Services (HTTP-In)</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Entrada</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Todos</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Sim</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Permitir</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">DNS (UDP-In)</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Entrada</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Domínio</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Sim</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Permitir</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Core Networking - DHCP (UDP-Out)</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Saída</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Todos</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Sim</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Permitir</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }
        
        function createWindowsDefenderContent() {
            return `
                <div class="firewall-panel">
                    <div class="firewall-header">
                        <img src="df.png" alt="Windows Defender">
                        <div class="firewall-header-text">
                            <h2>Windows Defender</h2>
                            <p>Proteja seu servidor contra vírus, malware e outras ameaças</p>
                        </div>
                    </div>
                    
                    <div class="firewall-status">
                        <img src="df.png" alt="Windows Defender" class="firewall-status-icon">
                        <div class="firewall-status-text">
                            <h3>${state.settings.antivirus ? 'A proteção contra vírus e ameaças está ativada' : 'A proteção contra vírus e ameaças está desativada'}</h3>
                            <p>${state.settings.antivirus ? 'Seu servidor está protegido contra ameaças' : 'Seu servidor está vulnerável a ameaças'}</p>
                            <button class="btn ${state.settings.antivirus ? 'btn-secondary' : 'btn-primary'}" onclick="toggleAntivirus()">${state.settings.antivirus ? 'Desativar proteção' : 'Ativar proteção'}</button>
                        </div>
                    </div>
                    
                    <div class="firewall-actions">
                        <div class="firewall-action" onclick="runQuickScan()">
                            <img src="https://cdn-icons-png.flaticon.com/512/3523/3523314.png" alt="Quick Scan">
                            <div>Verificação Rápida</div>
                        </div>
                        <div class="firewall-action" onclick="runFullScan()">
                            <img src="https://cdn-icons-png.flaticon.com/512/2145/2145092.png" alt="Full Scan">
                            <div>Verificação Completa</div>
                        </div>
                        <div class="firewall-action" onclick="runCustomScan()">
                            <img src="https://cdn-icons-png.flaticon.com/512/3132/3132141.png" alt="Custom Scan">
                            <div>Verificação Personalizada</div>
                        </div>
                        <div class="firewall-action" onclick="updateDefinitions()">
                            <img src="https://cdn-icons-png.flaticon.com/512/686/686344.png" alt="Update">
                            <div>Atualizar Definições</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Histórico de Proteção</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                            <thead>
                                <tr style="background-color: #f0f0f0;">
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Data</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Tipo</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Resultado</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Ação</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">10/06/2025 08:30</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Verificação Rápida</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Nenhuma ameaça encontrada</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">-</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">09/06/2025 15:45</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Proteção em Tempo Real</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Ameaça bloqueada: Trojan.Win32.Generic</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Removido</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">08/06/2025 22:15</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Verificação Completa</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Nenhuma ameaça encontrada</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">-</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">08/06/2025 10:30</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Atualização de Definições</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Atualizado para versão 1.385.2942.0</td>
                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Configurações de Proteção</h3>
                        <div style="background-color: #f9f9f9; border: 1px solid #ddd; padding: 15px; margin-top: 10px; border-radius: 4px;">
                            <div class="settings-option">
                                <div class="settings-option-info">
                                    <div class="settings-option-title">Proteção em Tempo Real</div>
                                    <div class="settings-option-description">Monitora continuamente seu servidor para detectar ameaças</div>
                                </div>
                                <div class="settings-toggle ${state.settings.wolfGuardFeatures.realTimeScan ? 'active' : ''}" onclick="toggleWolfGuardFeature('realTimeScan')"></div>
                            </div>
                            
                            <div class="settings-option" style="margin-top: 15px;">
                                <div class="settings-option-info">
                                    <div class="settings-option-title">Proteção Baseada em Nuvem</div>
                                    <div class="settings-option-description">Usa inteligência da nuvem para detecção avançada de ameaças</div>
                                </div>
                                <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                            </div>
                            
                            <div class="settings-option" style="margin-top: 15px;">
                                <div class="settings-option-info">
                                    <div class="settings-option-title">Envio Automático de Amostras</div>
                                    <div class="settings-option-description">Envia amostras suspeitas para análise</div>
                                </div>
                                <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                            </div>
                            
                            <div class="settings-option" style="margin-top: 15px;">
                                <div class="settings-option-info">
                                    <div class="settings-option-title">Proteção contra Adulteração</div>
                                    <div class="settings-option-description">Impede que programas maliciosos desativem a proteção</div>
                                </div>
                                <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createRemoteDesktopContent() {
            return `
                <div style="padding: 20px;">
                    <h2>Conexão de Área de Trabalho Remota</h2>
                    <p style="margin-bottom: 20px;">Conecte-se a um computador remoto usando Área de Trabalho Remota</p>
                    
                    <div style="background-color: white; border: 1px solid #ddd; padding: 20px; border-radius: 4px;">
                        <div class="form-group">
                            <label for="remote-computer">Computador:</label>
                            <input type="text" id="remote-computer" placeholder="Digite o nome do computador ou endereço IP">
                        </div>
                        
                        <div class="form-group">
                            <label for="remote-username">Nome de usuário:</label>
                            <input type="text" id="remote-username" placeholder="Digite o nome de usuário">
                        </div>
                        
                        <div style="margin-top: 10px;">
                            <button class="btn btn-primary" onclick="connectToRemoteDesktop()">Conectar</button>
                            <button class="btn btn-secondary" style="margin-left: 10px;">Opções</button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Conexões Recentes</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; border-radius: 4px; margin-top: 10px;">
                            <div style="display: flex; align-items: center; padding: 5px; cursor: pointer;" onclick="setRemoteComputer('DC-01.example.local')">
                                <img src="https://cdn-icons-png.flaticon.com/512/5289/5289039.png" style="width: 24px; height: 24px; margin-right: 10px;">
                                <span>DC-01.example.local</span>
                            </div>
                            <div style="display: flex; align-items: center; padding: 5px; cursor: pointer;" onclick="setRemoteComputer('SQL-SERVER.example.local')">
                                <img src="https://cdn-icons-png.flaticon.com/512/5289/5289039.png" style="width: 24px; height: 24px; margin-right: 10px;">
                                <span>SQL-SERVER.example.local</span>
                            </div>
                            <div style="display: flex; align-items: center; padding: 5px; cursor: pointer;" onclick="setRemoteComputer('192.168.1.50')">
                                <img src="https://cdn-icons-png.flaticon.com/512/5289/5289039.png" style="width: 24px; height: 24px; margin-right: 10px;">
                                <span>192.168.1.50</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Configurações de Área de Trabalho Remota</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; border-radius: 4px; margin-top: 10px;">
                            <div class="settings-option">
                                <div class="settings-option-info">
                                    <div class="settings-option-title">Permitir conexões remotas para este computador</div>
                                    <div class="settings-option-description">Permite que outros computadores se conectem a este servidor usando Área de Trabalho Remota</div>
                                </div>
                                <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                            </div>
                            
                            <div class="settings-option" style="margin-top: 15px;">
                                <div class="settings-option-info">
                                    <div class="settings-option-title">Permitir conexões apenas de computadores executando Área de Trabalho Remota com Autenticação de Rede</div>
                                    <div class="settings-option-description">Requer um nível mais alto de segurança para conexões remotas</div>
                                </div>
                                <div class="settings-toggle active" onclick="toggleSetting(this)"></div>
                            </div>
                            
                            <div style="margin-top: 15px;">
                                <button class="btn btn-secondary">Selecionar Usuários...</button>
                                <p style="margin-top: 5px; font-size: 12px; color: #666;">Especifique quais usuários podem se conectar remotamente a este computador</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createTaskSchedulerContent() {
            return `
                <div style="padding: 20px;">
                    <h2>Agendador de Tarefas</h2>
                    <p style="margin-bottom: 20px;">Crie e gerencie tarefas agendadas</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Criar Tarefa Básica...</button>
                            <button class="btn btn-primary" style="margin-right: 5px;">Criar Tarefa...</button>
                            <button class="btn btn-secondary">Importar Tarefa...</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 500px; border: 1px solid #ddd;">
                        <div style="width: 250px; border-right: 1px solid #ddd; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Biblioteca do Agendador de Tarefas</div>
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="padding: 5px; cursor: pointer; background-color: #e0e0e0;">Agendador de Tarefas (Local)</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">Microsoft</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Windows</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">Tarefas do Servidor</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">WolfGuard</li>
                            </ul>
                        </div>
                        
                        <div style="flex-grow: 1; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Tarefas Agendadas</div>
                            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Status</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Gatilhos</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Próxima Execução</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Backup do Sistema</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Pronto</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Diariamente às 02:00</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">11/06/2025 02:00</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Atualização de Definições de Vírus</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Pronto</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">A cada 4 horas</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">10/06/2025 12:00</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Verificação do Sistema</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Pronto</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Semanalmente aos domingos às 00:00</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">16/06/2025 00:00</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Sincronização do Active Directory</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Pronto</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">A cada hora</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">10/06/2025 11:00</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Rotação de Logs</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Pronto</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Diariamente às 23:00</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">10/06/2025 23:00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Resumo da Tarefa Selecionada</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                <div>Nome:</div>
                                <div>Backup do Sistema</div>
                                
                                <div>Descrição:</div>
                                <div>Realiza backup completo do sistema para o disco E:</div>
                                
                                <div>Status:</div>
                                <div>Pronto</div>
                                
                                <div>Autor:</div>
                                <div>SYSTEM</div>
                                
                                <div>Criado em:</div>
                                <div>05/06/2025 15:30</div>
                                
                                <div>Última execução:</div>
                                <div>10/06/2025 02:00</div>
                                
                                <div>Resultado da última execução:</div>
                                <div>Concluído com êxito (0x0)</div>
                                
                                <div>Próxima execução:</div>
                                <div>11/06/2025 02:00</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createHyperVContent() {
            let vmList = '';
            for (const vm of state.hyper_v.vms) {
                vmList += `
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${vm.name}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: ${vm.status === 'running' ? 'green' : 'red'};">${vm.status === 'running' ? 'Em execução' : 'Parado'}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${vm.memory}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${vm.cpus}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${vm.notes}</td>
                    </tr>
                `;
            }
            
            return `
                <div style="padding: 15px;">
                    <h2>Hyper-V Manager</h2>
                    <p style="margin-bottom: 20px;">Gerencie máquinas virtuais e configurações de virtualização.</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Nova VM</button>
                            <button class="btn btn-primary" style="margin-right: 5px;">Nova Rede Virtual</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 400px;">
                        <div style="width: 250px; border: 1px solid #ddd; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Servidores Hyper-V</div>
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="padding: 5px; cursor: pointer; background-color: #e0e0e0;">WIN-SRV2025</li>
                            </ul>
                        </div>
                        
                        <div style="flex-grow: 1; border: 1px solid #ddd; border-left: none; padding: 10px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Máquinas Virtuais</div>
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Status</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Memória</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">CPUs</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Notas</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${vmList}
                                </tbody>
                            </table>
                            
                            <div style="margin-top: 20px;">
                                <h3>Ações</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                        <button class="btn btn-secondary">Iniciar</button>
                                        <button class="btn btn-secondary">Desligar</button>
                                        <button class="btn btn-secondary">Salvar Estado</button>
                                        <button class="btn btn-secondary">Conectar</button>
                                        <button class="btn btn-secondary">Configurações</button>
                                        <button class="btn btn-secondary">Checkpoint</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>Resumo de Recursos</h3>
                        <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                <div>CPUs Físicas:</div>
                                <div>12 núcleos (24 threads)</div>
                                
                                <div>CPUs Virtuais em Uso:</div>
                                <div>14 de 24 (58%)</div>
                                
                                <div>Memória Física:</div>
                                <div>32 GB</div>
                                
                                <div>Memória Virtual em Uso:</div>
                                <div>24 GB de 32 GB (75%)</div>
                                
                                <div>Armazenamento Total:</div>
                                <div>3.5 TB</div>
                                
                                <div>Armazenamento em Uso:</div>
                                <div>1.2 TB (34%)</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createDNSManagerContent() {
            let zoneList = '';
            for (const zone of state.dns.zones) {
                zoneList += `
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${zone.name}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${zone.type}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${zone.records}</td>
                    </tr>
                `;
            }
            
            return `
                <div style="padding: 15px;">
                    <h2>DNS Manager</h2>
                    <p style="margin-bottom: 20px;">Gerencie zonas e registros DNS.</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Nova Zona</button>
                            <button class="btn btn-primary" style="margin-right: 5px;">Novo Registro</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 400px;">
                        <div style="width: 250px; border: 1px solid #ddd; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Servidores DNS</div>
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="padding: 5px; cursor: pointer; background-color: #e0e0e0;">WIN-SRV2025</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">Zonas Diretas</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">example.local</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">Zonas Reversas</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">168.192.in-addr.arpa</li>
                            </ul>
                        </div>
                        
                        <div style="flex-grow: 1; border: 1px solid #ddd; border-left: none; padding: 10px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Zonas DNS</div>
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome da Zona</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Tipo</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Registros</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${zoneList}
                                </tbody>
                            </table>
                            
                            <div style="margin-top: 20px;">
                                <h3>Registros da Zona Selecionada</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr style="background-color: #f0f0f0;">
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Tipo</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Dados</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">TTL</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">@ (example.local)</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">SOA</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">ns1.example.local admin.example.local</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">3600</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">@ (example.local)</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">NS</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">ns1.example.local</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">3600</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">ns1</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">A</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.100</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">3600</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">www</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">A</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.101</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">3600</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">mail</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">A</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.102</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">3600</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createDHCPManagerContent() {
            let scopeList = '';
            for (const scope of state.dhcp.scopes) {
                scopeList += `
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${scope.name}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${scope.range}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${scope.leased}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${scope.reservations}</td>
                    </tr>
                `;
            }
            
            return `
                <div style="padding: 15px;">
                    <h2>DHCP Manager</h2>
                    <p style="margin-bottom: 20px;">Gerencie escopos e configurações DHCP.</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Novo Escopo</button>
                            <button class="btn btn-primary" style="margin-right: 5px;">Nova Reserva</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 400px;">
                        <div style="width: 250px; border: 1px solid #ddd; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Servidores DHCP</div>
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="padding: 5px; cursor: pointer; background-color: #e0e0e0;">WIN-SRV2025</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">IPv4</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Escopos</li>
                                <li style="padding: 5px; margin-left: 45px; cursor: pointer;">LAN (192.168.1.0)</li>
                                <li style="padding: 5px; margin-left: 45px; cursor: pointer;">WiFi (192.168.2.0)</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Políticas de Escopo</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">IPv6</li>
                            </ul>
                        </div>
                        
                        <div style="flex-grow: 1; border: 1px solid #ddd; border-left: none; padding: 10px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Escopos DHCP</div>
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Faixa de IPs</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Leases Ativos</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Reservas</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${scopeList}
                                </tbody>
                            </table>
                            
                            <div style="margin-top: 20px;">
                                <h3>Detalhes do Escopo Selecionado</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Nome:</div>
                                        <div>LAN</div>
                                        
                                        <div>Faixa de IPs:</div>
                                        <div>192.168.1.100 - 192.168.1.200</div>
                                        
                                        <div>Máscara de Sub-rede:</div>
                                        <div>255.255.255.0</div>
                                        
                                        <div>Gateway Padrão:</div>
                                        <div>192.168.1.1</div>
                                        
                                        <div>Servidores DNS:</div>
                                        <div>192.168.1.1, 8.8.8.8</div>
                                        
                                        <div>Tempo de Lease:</div>
                                        <div>8 dias</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <h3>Leases Ativos</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr style="background-color: #f0f0f0;">
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Endereço IP</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome do Host</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Endereço MAC</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Expiração</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.120</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">LAPTOP-USER1</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">00:1B:44:11:3A:B7</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">18/06/2025 14:30</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.121</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">DESKTOP-USER2</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">00:1C:23:35:4B:2C</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">17/06/2025 09:15</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">192.168.1.122</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">MOBILE-USER3</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">00:25:96:12:34:56</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">16/06/2025 22:45</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createWindowsAdminCenterContent() {
            return `
                <div style="padding: 15px;">
                    <h2>Windows Admin Center</h2>
                    <p style="margin-bottom: 20px;">Console de gerenciamento baseada em navegador para administrar servidores Windows.</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Adicionar</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                        <div style="margin-left: auto;">
                            <input type="text" placeholder="Pesquisar..." style="padding: 5px 10px; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" onclick="switchAdminCenterTab('servers')">Servidores</div>
                        <div class="tab" onclick="switchAdminCenterTab('clusters')">Clusters</div>
                        <div class="tab" onclick="switchAdminCenterTab('extensions')">Extensões</div>
                        <div class="tab" onclick="switchAdminCenterTab('settings')">Configurações</div>
                    </div>
                    
                    <div id="servers-tab" class="tab-content active">
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; margin-top: 20px;">
                            <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white;">
                                <div style="font-weight: bold; margin-bottom: 10px;">WIN-SRV2025</div>
                                <div style="margin-bottom: 10px;">192.168.1.100</div>
                                <div style="color: green; margin-bottom: 10px;">● Online</div>
                                <div style="display: flex; justify-content: flex-end;">
                                    <button class="btn btn-primary">Conectar</button>
                                </div>
                            </div>
                            
                            <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white;">
                                <div style="font-weight: bold; margin-bottom: 10px;">SQL-SERVER</div>
                                <div style="margin-bottom: 10px;">192.168.1.101</div>
                                <div style="color: green; margin-bottom: 10px;">● Online</div>
                                <div style="display: flex; justify-content: flex-end;">
                                    <button class="btn btn-primary">Conectar</button>
                                </div>
                            </div>
                            
                            <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white;">
                                <div style="font-weight: bold; margin-bottom: 10px;">EXCHANGE-SRV</div>
                                <div style="margin-bottom: 10px;">192.168.1.102</div>
                                <div style="color: red; margin-bottom: 10px;">● Offline</div>
                                <div style="display: flex; justify-content: flex-end;">
                                    <button class="btn btn-primary" disabled>Conectar</button>
                                </div>
                            </div>
                            
                            <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white; display: flex; justify-content: center; align-items: center; flex-direction: column; cursor: pointer;">
                                <div style="font-size: 24px; margin-bottom: 10px;">+</div>
                                <div>Adicionar</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="clusters-tab" class="tab-content">
                        <div style="margin-top: 20px; text-align: center; padding: 50px; background-color: white; border: 1px solid #ddd;">
                            <div style="font-size: 18px; margin-bottom: 15px;">Nenhum cluster encontrado</div>
                            <button class="btn btn-primary">Adicionar Cluster</button>
                        </div>
                    </div>
                    
                    <div id="extensions-tab" class="tab-content">
                        <div style="margin-top: 20px;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                                <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white;">
                                    <div style="font-weight: bold; margin-bottom: 10px;">Active Directory</div>
                                    <div style="margin-bottom: 10px;">Gerenciamento de domínio e usuários</div>
                                    <div style="color: green; margin-bottom: 10px;">✓ Instalado</div>
                                </div>
                                
                                <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white;">
                                    <div style="font-weight: bold; margin-bottom: 10px;">DNS</div>
                                    <div style="margin-bottom: 10px;">Gerenciamento de DNS</div>
                                    <div style="color: green; margin-bottom: 10px;">✓ Instalado</div>
                                </div>
                                
                                <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white;">
                                    <div style="font-weight: bold; margin-bottom: 10px;">DHCP</div>
                                    <div style="margin-bottom: 10px;">Gerenciamento de DHCP</div>
                                    <div style="color: green; margin-bottom: 10px;">✓ Instalado</div>
                                </div>
                                
                                <div style="border: 1px solid #ddd; border-radius: 4px; padding: 15px; background-color: white;">
                                    <div style="font-weight: bold; margin-bottom: 10px;">Storage Replica</div>
                                    <div style="margin-bottom: 10px;">Replicação de armazenamento</div>
                                    <div style="margin-bottom: 10px;">Não instalado</div>
                                    <div style="display: flex; justify-content: flex-end;">
                                        <button class="btn btn-primary">Instalar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="settings-tab" class="tab-content">
                        <div style="margin-top: 20px; background-color: white; border: 1px solid #ddd; padding: 20px;">
                            <h3 style="margin-bottom: 15px;">Configurações Gerais</h3>
                            
                            <div class="form-group">
                                <label>Idioma:</label>
                                <select>
                                    <option>Português (Brasil)</option>
                                    <option>English (United States)</option>
                                    <option>Español</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>Tema:</label>
                                <select>
                                    <option>Claro</option>
                                    <option>Escuro</option>
                                    <option>Sistema</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>Timeout de Sessão:</label>
                                <select>
                                    <option>5 minutos</option>
                                    <option>10 minutos</option>
                                    <option>15 minutos</option>
                                    <option>30 minutos</option>
                                    <option>1 hora</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>Telemetria:</label>
                                <div>
                                    <input type="checkbox" id="telemetry-checkbox" checked>
                                    <label for="telemetry-checkbox">Enviar dados de diagnóstico para a Microsoft</label>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn btn-primary">Salvar</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createGroupPolicyContent() {
            return `
                <div style="padding: 15px;">
                    <h2>Group Policy Management</h2>
                    <p style="margin-bottom: 20px;">Gerenciamento de Políticas de Grupo para o domínio.</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Nova GPO</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; height: 500px;">
                        <div style="width: 300px; border: 1px solid #ddd; padding: 10px; overflow-y: auto;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Floresta: example.local</div>
                            <ul style="list-style-type: none; padding-left: 0;">
                                <li style="padding: 5px; cursor: pointer;">Domínios</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer; background-color: #e0e0e0;">example.local</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Default Domain Policy</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Default Domain Controllers Policy</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Workstation Security Policy</li>
                                <li style="padding: 5px; margin-left: 30px; cursor: pointer;">Server Security Policy</li>
                                <li style="padding: 5px; margin-left: 15px; cursor: pointer;">Sites</li>
                                <li style="padding: 5px; cursor: pointer;">Group Policy Objects</li>
                                <li style="padding: 5px; cursor: pointer;">WMI Filters</li>
                                <li style="padding: 5px; cursor: pointer;">Starter GPOs</li>
                            </ul>
                        </div>
                        
                        <div style="flex-grow: 1; border: 1px solid #ddd; border-left: none; padding: 10px;">
                            <div style="font-weight: bold; margin-bottom: 10px;">Políticas de Grupo no Domínio example.local</div>
                            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Status</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">GPO Status</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Modificado</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Default Domain Policy</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Ativado</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Configurações de usuário e computador ativadas</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">05/06/2025</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Default Domain Controllers Policy</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Ativado</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Configurações de usuário e computador ativadas</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">05/06/2025</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Workstation Security Policy</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Ativado</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Apenas configurações de computador ativadas</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">08/06/2025</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Server Security Policy</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Ativado</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Apenas configurações de computador ativadas</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">08/06/2025</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div style="margin-top: 20px;">
                                <h3>Detalhes da Política Selecionada</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <div class="tabs">
                                        <div class="tab active" onclick="switchGPOTab('gpo-scope')">Escopo</div>
                                        <div class="tab" onclick="switchGPOTab('gpo-details')">Detalhes</div>
                                        <div class="tab" onclick="switchGPOTab('gpo-settings')">Configurações</div>
                                        <div class="tab" onclick="switchGPOTab('gpo-delegation')">Delegação</div>
                                    </div>
                                    
                                    <div id="gpo-scope-tab" class="tab-content active" style="padding: 15px;">
                                        <h4>Links</h4>
                                        <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                            <thead>
                                                <tr style="background-color: #f0f0f0;">
                                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Local</th>
                                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Ativado</th>
                                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Aplicação</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">example.local</td>
                                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Sim</td>
                                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Aplicação forçada</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        
                                        <h4 style="margin-top: 15px;">Filtros de Segurança</h4>
                                        <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                            <thead>
                                                <tr style="background-color: #f0f0f0;">
                                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Permissão</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Authenticated Users</td>
                                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Apply Group Policy (Allow)</td>
                                                </tr>
                                                <tr>
                                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Domain Admins</td>
                                                    <td style="padding: 8px; border-bottom: 1px solid #ddd;">Full Control (Allow)</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function createStorageManagerContent() {
            let driveList = '';
            for (const drive of state.storage.drives) {
                const usedPercentage = (drive.usedSpace / drive.totalSpace) * 100;
                driveList += `
                    <tr>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${drive.letter}:</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${drive.label}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${drive.type}</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${drive.usedSpace} GB de ${drive.totalSpace} GB</td>
                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${usedPercentage}%"></div>
                            </div>
                        </td>
                    </tr>
                `;
            }
            
            return `
                <div style="padding: 15px;">
                    <h2>Storage Manager</h2>
                    <p style="margin-bottom: 20px;">Gerencie armazenamento, volumes, compartilhamentos e pools de armazenamento.</p>
                    
                    <div style="display: flex; margin-bottom: 20px;">
                        <div style="margin-right: 15px;">
                            <button class="btn btn-primary" style="margin-right: 5px;">Novo Volume</button>
                            <button class="btn btn-primary" style="margin-right: 5px;">Novo Compartilhamento</button>
                            <button class="btn btn-secondary">Atualizar</button>
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" onclick="switchStorageTab('volumes')">Volumes</div>
                        <div class="tab" onclick="switchStorageTab('shares')">Compartilhamentos</div>
                        <div class="tab" onclick="switchStorageTab('storage-pools')">Pools de Armazenamento</div>
                        <div class="tab" onclick="switchStorageTab('disks')">Discos</div>
                    </div>
                    
                    <div id="volumes-tab" class="tab-content active">
                        <div style="margin-top: 20px;">
                            <h3>Volumes</h3>
                            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Unidade</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Rótulo</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Sistema de Arquivos</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Espaço Utilizado</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Utilização</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${driveList}
                                </tbody>
                            </table>
                            
                            <div style="margin-top: 20px;">
                                <h3>Propriedades do Volume Selecionado</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Unidade:</div>
                                        <div>C:</div>
                                        
                                        <div>Rótulo:</div>
                                        <div>System</div>
                                        
                                        <div>Sistema de Arquivos:</div>
                                        <div>NTFS</div>
                                        
                                        <div>Tamanho Total:</div>
                                        <div>500 GB</div>
                                        
                                        <div>Espaço Utilizado:</div>
                                        <div>120 GB (24%)</div>
                                        
                                        <div>Espaço Livre:</div>
                                        <div>380 GB (76%)</div>
                                        
                                        <div>Tipo de Volume:</div>
                                        <div>Simples</div>
                                        
                                        <div>Disco:</div>
                                        <div>Disco 0</div>
                                        
                                        <div>Estado:</div>
                                        <div style="color: green;">Saudável</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="shares-tab" class="tab-content">
                        <div style="margin-top: 20px;">
                            <h3>Compartilhamentos</h3>
                            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Caminho</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Descrição</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Tipo</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Users$</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">C:\\Users</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Pastas de usuários</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Compartilhamento administrativo</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Public</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">D:\\Shares\\Public</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Compartilhamento público</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Compartilhamento de pasta</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Departments</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">D:\\Shares\\Departments</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Pastas de departamentos</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Compartilhamento de pasta</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div style="margin-top: 20px;">
                                <h3>Permissões do Compartilhamento Selecionado</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                        <thead>
                                            <tr style="background-color: #f0f0f0;">
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Nome</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Tipo</th>
                                                <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Permissão</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Everyone</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Grupo integrado</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Leitura</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Administrators</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Grupo integrado</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Controle total</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Domain Users</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Grupo de segurança</td>
                                                <td style="padding: 8px; border-bottom: 1px solid #ddd;">Alteração</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="storage-pools-tab" class="tab-content">
                        <div style="margin-top: 20px; text-align: center; padding: 50px; background-color: white; border: 1px solid #ddd;">
                            <div style="font-size: 18px; margin-bottom: 15px;">Nenhum pool de armazenamento encontrado</div>
                            <button class="btn btn-primary">Criar Pool de Armazenamento</button>
                        </div>
                    </div>
                    
                    <div id="disks-tab" class="tab-content">
                        <div style="margin-top: 20px;">
                            <h3>Discos Físicos</h3>
                            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                                <thead>
                                    <tr style="background-color: #f0f0f0;">
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Disco</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Status</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Tipo</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Capacidade</th>
                                        <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Livre</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Disco 0</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: green;">Online</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">SSD</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">500 GB</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">0 GB</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Disco 1</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: green;">Online</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">HDD</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">1000 GB</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">0 GB</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">Disco 2</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd; color: green;">Online</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">HDD</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">2000 GB</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #ddd;">0 GB</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div style="margin-top: 20px;">
                                <h3>Propriedades do Disco Selecionado</h3>
                                <div style="background-color: white; border: 1px solid #ddd; padding: 15px; margin-top: 10px;">
                                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px;">
                                        <div>Disco:</div>
                                        <div>Disco 0</div>
                                        
                                        <div>Modelo:</div>
                                        <div>Samsung SSD 970 EVO 500GB</div>
                                        
                                        <div>Tipo:</div>
                                        <div>SSD</div>
                                        
                                        <div>Interface:</div>
                                        <div>NVMe</div>
                                        
                                        <div>Capacidade:</div>
                                        <div>500 GB</div>
                                        
                                        <div>Status:</div>
                                        <div style="color: green;">Online</div>
                                        
                                        <div>Partições:</div>
                                        <div>1</div>
                                        
                                        <div>Saúde do Disco:</div>
                                        <div style="color: green;">Bom (98%)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Funções para lidar com comandos do PowerShell
        function handlePowerShellCommand(event) {
            if (event.key === 'Enter') {
                const command = event.target.value;
                const output = document.getElementById('powershell-output');
                
                // Adicionar comando à saída
                output.innerHTML += `<div>PS C:\\Users\\Administrator> ${command}</div>`;
                
                // Executar comando
                const result = executePowerShellCommand(command);
                
                // Adicionar resultado à saída
                output.innerHTML += result;
                
                // Limpar input
                event.target.value = '';
                
                // Rolar para baixo
                output.scrollTop = output.scrollHeight;
            }
        }
        
        function executePowerShellCommand(command) {
            let result = '';
            
            // Comandos básicos
            if (command.toLowerCase() === 'get-help') {
                result = `
                    <div>
                        Comandos comuns do PowerShell:
                        Get-Help - Exibe ajuda para comandos do PowerShell
                        Get-Command - Lista todos os comandos disponíveis
                        Get-Process - Lista processos em execução
                        Get-Service - Lista serviços
                        Get-NetIPAddress - Exibe configurações de IP
                        Get-NetAdapter - Lista adaptadores de rede
                        Get-ComputerInfo - Exibe informações do sistema
                        Get-ADUser - Lista usuários do Active Directory
                        Get-ADComputer - Lista computadores do Active Directory
                        SSH - Conecta a um host remoto usando SSH
                        SCP - Copia arquivos de/para um host remoto
                        Invoke-WebRequest - Realiza requisições HTTP/HTTPS
                        Invoke-RestMethod - Consome APIs REST
                    </div>
                `;
            } else if (command.toLowerCase() === 'get-computerinfo') {
                result = `
                    <div>
                        WindowsProductName     : Windows Server 2025 Standard
                        WindowsVersion         : 25000.1000
                        OsHardwareAbstractionLayer : 10.0.25000.1000
                        CsManufacturer         : Microsoft Corporation
                        CsModel                : Virtual Machine
                        CsName                 : WIN-SRV2025
                        CsProcessors           : {Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz}
                        CsNumberOfLogicalProcessors : 24
                        CsNumberOfProcessors   : 1
                        CsTotalPhysicalMemory  : 34359738368
                        CsDomain               : example.local
                        CsDomainRole           : DomainController
                        OsBootDevice           : \\Device\\HarddiskVolume1
                        OsSystemDirectory      : C:\\Windows\\system32
                        OsWindowsDirectory     : C:\\Windows
                    </div>
                `;
            } else if (command.toLowerCase() === 'get-netipaddress') {
                result = `
                    <div>
                        IPAddress         : ${state.ipConfig.ipAddress}
                        InterfaceIndex    : 12
                        InterfaceAlias    : Ethernet
                        AddressFamily     : IPv4
                        Type              : Unicast
                        PrefixLength      : 24
                        PrefixOrigin      : Manual
                        SuffixOrigin      : Manual
                        AddressState      : Preferred
                        ValidLifetime     : Infinite ([TimeSpan]::MaxValue)
                        PreferredLifetime : Infinite ([TimeSpan]::MaxValue)
                        SkipAsSource      : False
                        PolicyStore       : ActiveStore
                    </div>
                `;
            } else if (command.toLowerCase() === 'get-service') {
                result = `
                    <div>
                        Status   Name               DisplayName
                        ------   ----               -----------
                        Running  ADWS               Active Directory Web Services
                        Running  BFE                Base Filtering Engine
                        Running  CertPropSvc        Certificate Propagation
                        Running  CryptSvc           Cryptographic Services
                        Running  DFS                DFS Namespace
                        Running  DFSR               DFS Replication
                        Running  Dhcp               DHCP Client
                        Running  DNS                DNS Server
                        Running  Dnscache           DNS Client
                        Running  EventLog           Windows Event Log
                        Running  EventSystem        COM+ Event System
                        Running  gpsvc              Group Policy Client
                        Running  IISAdmin           IIS Admin Service
                        Running  IKEEXT             IKE and AuthIP IPsec Keying Modules
                        Running  iphlpsvc           IP Helper
                        Running  Kdc                Kerberos Key Distribution Center
                        Running  LanmanServer       Server
                        Running  LanmanWorkstation  Workstation
                        Running  MpsSvc             Windows Firewall
                        Running  MSDTC              Distributed Transaction Coordinator
                        Running  Netlogon           Netlogon
                        Running  NlaSvc             Network Location Awareness
                        Running  NTDS               Active Directory Domain Services
                        Running  PlugPlay           Plug and Play
                        Running  PolicyAgent        IPsec Policy Agent
                        Running  Power              Power
                        Running  RpcEptMapper       RPC Endpoint Mapper
                        Running  RpcSs              Remote Procedure Call (RPC)
                        Running  SamSs              Security Accounts Manager
                        Running  Schedule           Task Scheduler
                        Running  SQLTELEMETRY       SQL Server CEIP service
                        Running  W3SVC              World Wide Web Publishing Service
                        Running  WinHttpAutoProxySvc WinHTTP Web Proxy Auto-Discovery Service
                        Running  Winmgmt            Windows Management Instrumentation
                        Running  WinRM              Windows Remote Management (WS-Management)
                        ${state.settings.antivirus ? 'Running' : 'Stopped'}  WolfGuard          WolfGuard Antivirus Service
                        ${state.settings.firewall ? 'Running' : 'Stopped'}  MpsSvc             Windows Firewall
                        Stopped  SQLBrowser         SQL Server Browser
                        Stopped  SQLWriter          SQL Server VSS Writer
                    </div>
                `;
            } else if (command.toLowerCase() === 'get-process') {
                result = `
                    <div>
                        Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
                        -------  ------    -----      -----     ------     --  -- -----------
                            386      21    11888      21676       0.52   2844   0 csrss
                            258      16     2872       9136       0.08   3160   0 dfsrs
                            652      46    34452      47056       3.30   3380   0 dns
                            395      31    23740      38456       1.11   1020   0 inetinfo
                            182      11     1852       5864       0.08   3600   0 ismserv
                            897      31    12708      42560       2.44   2368   0 lsass
                            438      14     3244      11096       1.59   1160   0 services
                            379      16     3780      12388       0.16   2544   0 smss
                            328      14     2712       7612       0.33   3808   0 spoolsv
                            382      19     3240      10460       0.28   1652   0 svchost
                            510      21     5840      17644       0.97   1744   0 svchost
                            667      33    10344      20648       3.91   1780   0 svchost
                            554      26     6368      20212       0.59   1920   0 svchost
                            615      43    13768      31040       2.03   2300   0 svchost
                            433      18     4952      13660       0.56   2676   0 svchost
                            522      15     3560      10920       0.69   2832   0 svchost
                            538      27     6080      23024       0.95   3480   0 svchost
                            435      37    10856      20804       0.66   3600   0 svchost
                            427      19     3504      10904       0.55   3716   0 svchost
                            498      29     6940      24740       2.16   3852   0 svchost
                            443      17     4424      12372       0.34   4044   0 svchost
                            427      14     4256      11704       0.69   4180   0 svchost
                            218      12     2284       8540       0.14   4452   0 vds
                            421      17     2016       8100       0.30   4584   0 wininit
                            535      31    19508      33364       1.03   4740   0 w3wp
                            ${state.settings.antivirus ? '532      35    28744      42128       2.15   3850   0 wolfguard' : ''}
                    </div>
                `;
            } else if (command.toLowerCase() === 'ipconfig') {
                result = `
                    <div>
                        Configuração de IP do Windows

                        Adaptador Ethernet Ethernet:

                           Sufixo DNS específico de conexão. . . . . . : example.local
                           Endereço IPv4. . . . . . . . . . . . . . . . : ${state.ipConfig.ipAddress}
                           Máscara de Sub-rede . . . . . . . . . . . . : ${state.ipConfig.subnetMask}
                           Gateway Padrão. . . . . . . . . . . . . . . : ${state.ipConfig.gateway}
                    </div>
                `;
            } else if (command.toLowerCase() === 'hostname') {
                result = `
                    <div>${state.computerName}</div>
                `;
            } else if (command.toLowerCase() === 'get-aduser -filter *') {
                result = `
                    <div>
                        DistinguishedName : CN=Administrator,CN=Users,DC=example,DC=local
                        Enabled           : True
                        GivenName         : 
                        Name              : Administrator
                        ObjectClass       : user
                        ObjectGUID        : 2b826492-8b3a-4538-a51b-7d4f759b3b34
                        SamAccountName    : Administrator
                        SID               : S-1-5-21-3842939050-3880317879-2865463114-500
                        Surname           : 
                        UserPrincipalName : 

                        DistinguishedName : CN=Guest,CN=Users,DC=example,DC=local
                        Enabled           : False
                        GivenName         : 
                        Name              : Guest
                        ObjectClass       : user
                        ObjectGUID        : a3f4ac7b-f535-45dc-8091-a59c3bc3b99e
                        SamAccountName    : Guest
                        SID               : S-1-5-21-3842939050-3880317879-2865463114-501
                        Surname           : 
                        UserPrincipalName : 

                        DistinguishedName : CN=John Doe,CN=Users,DC=example,DC=local
                        Enabled           : True
                        GivenName         : John
                        Name              : John Doe
                        ObjectClass       : user
                        ObjectGUID        : 91ce80a7-1c0d-44d8-90b9-38bbcf497c38
                        SamAccountName    : jdoe
                        SID               : S-1-5-21-3842939050-3880317879-2865463114-1103
                        Surname           : Doe
                        UserPrincipalName : jdoe@example.local

                        DistinguishedName : CN=Jane Smith,CN=Users,DC=example,DC=local
                        Enabled           : True
                        GivenName         : Jane
                        Name              : Jane Smith
                        ObjectClass       : user
                        ObjectGUID        : 3c7dd4af-e10b-4539-8c1d-9601a8b8f1f2
                        SamAccountName    : jsmith
                        SID               : S-1-5-21-3842939050-3880317879-2865463114-1104
                        Surname           : Smith
                        UserPrincipalName : jsmith@example.local
                    </div>
                `;
            } else if (command.toLowerCase().startsWith('get-adcomputer')) {
                result = `
                    <div>
                        DistinguishedName : CN=WIN-SRV2025,OU=Domain Controllers,DC=example,DC=local
                        DNSHostName       : WIN-SRV2025.example.local
                        Enabled           : True
                        Name              : WIN-SRV2025
                        ObjectClass       : computer
                        ObjectGUID        : 64fc7e0a-9fc2-4319-b9b2-cd8d39aa1279
                        SamAccountName    : WIN-SRV2025$
                        SID               : S-1-5-21-3842939050-3880317879-2865463114-1001

                        DistinguishedName : CN=SQL-SERVER,CN=Computers,DC=example,DC=local
                        DNSHostName       : SQL-SERVER.example.local
                        Enabled           : True
                        Name              : SQL-SERVER
                        ObjectClass       : computer
                        ObjectGUID        : 2a8b1c2a-2b60-4f3e-8372-6fa4b1c3a18d
                        SamAccountName    : SQL-SERVER$
                        SID               : S-1-5-21-3842939050-3880317879-2865463114-1102

                        DistinguishedName : CN=FILESERVER,CN=Computers,DC=example,DC=local
                        DNSHostName       : FILESERVER.example.local
                        Enabled           : True
                        Name              : FILESERVER
                        ObjectClass       : computer
                        ObjectGUID        : 3b9c2d3a-4c70-5e4f-9483-7fa5b2c4b29e
                        SamAccountName    : FILESERVER$
                        SID               : S-1-5-21-3842939050-3880317879-2865463114-1103
                    </div>
                `;
            } else if (command.toLowerCase().startsWith('dir')) {
                let fileList = '';
                
                // Se estamos no desktop, mostrar arquivos e pastas do desktop
                if (command.toLowerCase() === 'dir desktop' || command.toLowerCase() === 'dir .\\desktop') {
                    if (state.fileSystem.desktop && Array.isArray(state.fileSystem.desktop)) {
                        state.fileSystem.desktop.forEach(item => {
                            const now = new Date();
                            const date = now.toLocaleDateString('pt-BR');
                            const time = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                            const type = item.type === 'folder' ? '<DIR>' : '';
                            const size = item.type === 'folder' ? '' : Math.floor(Math.random() * 1000);
                            
                            fileList += `
                                ${date}  ${time}    ${type.padEnd(5)}    ${size.toString().padStart(8)}  ${item.name}
                            `;
                        });
                    }
                    
                    result = `
                        <div>
                            Directory: C:\\Users\\Administrator\\Desktop

                            Mode                 LastWriteTime         Length Name
                            ----                 -------------         ------ ----
                            ${fileList}
                        </div>
                    `;
                } else {
                    result = `
                        <div>
                            Directory: C:\\Users\\Administrator

                            Mode                 LastWriteTime         Length Name
                            ----                 -------------         ------ ----
                            d----          10/06/2025     8:45                Desktop
                            d----          10/06/2025     8:45                Documents
                            d----          10/06/2025     8:45                Downloads
                            d----          10/06/2025     8:45                Pictures
                            d----          10/06/2025     8:45                Videos
                            -a---          10/06/2025     9:15           1546 report.docx
                            -a---          10/06/2025     9:30           2845 servers.xlsx
                            -a---          10/06/2025    10:15            845 notes.txt
                        </div>
                    `;
                }
            } else if (command.toLowerCase() === 'get-vm') {
                result = `
                    <div>
                        Name     State   CPUUsage(%) MemoryAssigned(M) Uptime           Status
                        ----     -----   ----------- ----------------- ------           ------
                        DC-01    Running 5           8192              1.12:24:50.4200  Operating normally
                        SQL-01   Running 25          16384             1.08:14:30.5110  Operating normally
                        WEB-01   Off     0           4096              00:00:00         Operating normally
                    </div>
                `;
            } else if (command.toLowerCase() === 'get-dnsclientserveraddress') {
                result = `
                    <div>
                        InterfaceAlias               Interface Address ServerAddresses
                                                     Index     Family
                        --------------               --------- ------- ---------------
                        Ethernet                     12        IPv4    {${state.ipConfig.dns1}, ${state.ipConfig.dns2}}
                    </div>
                `;
            } else if (command.toLowerCase() === 'systeminfo') {
                result = `
                    <div>
                        Nome do host:                 ${state.computerName}
                        Nome do sistema operacional:  Microsoft Windows Server 2025 Standard
                        Versão do sistema operacional: 10.0.25000 Build 25000
                        Fabricante do sistema operacional: Microsoft Corporation
                        Configuração do sistema operacional: Controlador de Domínio Principal
                        Tipo de Build do sistema operacional: Multiprocessor Free
                        Proprietário registrado:      Administrador
                        Organização registrada:       
                        Identificação do produto:     00123-45678-90123-ABCDE
                        Data da instalação original:  05/06/2025, 14:30:22
                        Horário de inicialização do sistema: 10/06/2025, 08:45:10
                        Fabricante do sistema:        Microsoft Corporation
                        Modelo do sistema:            Virtual Machine
                        Tipo de sistema:              x64-based PC
                        Processador(es):              1 Processador(es) Instalado(s).
                                                     [01]: Intel64 Family 6 Model 63 Stepping 2 GenuineIntel ~2501 Mhz
                        Versão do BIOS:               Hyper-V UEFI Release v4.0
                        Diretório do Windows:         C:\\Windows
                        Diretório do sistema:         C:\\Windows\\system32
                        Dispositivo de inicialização: \\Device\\HarddiskVolume1
                        Opção de instalação do sistema: Windows Server 2025
                        Configuração de rede:         Domínio
                        Domínio:                      example.local
                        Servidor de logon:            \\\\WIN-SRV2025
                        Hotfixes:                     3 Hotfix(es) Instalado(s).
                                                     [01]: KB5005101
                                                     [02]: KB5005365
                                                     [03]: KB5005698
                        Adaptadores de rede:          1 NIC(s) Instalado(s).
                                                     [01]: Ethernet
                                                           Nome da conexão: Ethernet
                                                           Status:          Conectado
                        Requisitos de assinatura:     Assinatura digital de driver não requerida
                    </div>
                `;
            } else if (command.toLowerCase().startsWith('cd ')) {
                result = `<div>O diretório foi alterado para ${command.substring(3)}</div>`;
            } else if (command.toLowerCase() === 'ls' || command.toLowerCase() === 'ls -la') {
                result = `
                    <div>
                        total 82256
                        drwxr-xr-x  15 admin  staff      480 Jun  9 20:13 .
                        drwxr-xr-x   3 admin  staff       96 Jun  9 17:21 ..
                        -rw-r--r--   1 admin  staff      845 Jun  9 18:35 notes.txt
                        -rw-r--r--   1 admin  staff     1546 Jun  9 19:22 report.docx
                        -rw-r--r--   1 admin  staff     2845 Jun  9 20:01 servers.xlsx
                        drwxr-xr-x   5 admin  staff      160 Jun  9 17:26 Desktop
                        drwxr-xr-x   3 admin  staff       96 Jun  9 17:24 Documents
                        drwxr-xr-x   7 admin  staff      224 Jun  9 17:34 Downloads
                    </div>
                `;
            } else if (command.toLowerCase() === 'net user') {
                result = `
                    <div>
                        Contas de usuário de \\\\WIN-SRV2025

                        -------------------------------------------------------------------------------
                        Administrator            Guest                    jdoe
                        jsmith
                        O comando foi concluído com êxito.
                    </div>
                `;
            } else if (command.toLowerCase() === 'net start') {
                result = `
                    <div>
                        Estes serviços do Windows estão iniciados:
                        
                        Active Directory Domain Services
                        Active Directory Web Services
                        DNS Client
                        DNS Server
                        DFS Namespace
                        DFS Replication
                        Group Policy Client
                        IIS Admin Service
                        Kerberos Key Distribution Center
                        Netlogon
                        Remote Procedure Call (RPC)
                        Security Accounts Manager
                        Windows Event Log
                        Windows Management Instrumentation
                        Windows Remote Management (WS-Management)
                        World Wide Web Publishing Service
                        ${state.settings.antivirus ? 'WolfGuard Antivirus Service' : ''}
                        ${state.settings.firewall ? 'Windows Firewall' : ''}
                        
                        O comando foi concluído com êxito.
                    </div>
                `;
            } else if (command.toLowerCase() === 'netstat -a') {
                result = `
                    <div>
                        Conexões Ativas

                        Proto  Endereço local        Endereço externo      Estado
                        TCP    0.0.0.0:80            0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:135           0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:443           0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:445           0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:3389          0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:5985          0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:47001         0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:49664         0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:49665         0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:49666         0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:49667         0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:49668         0.0.0.0:0             LISTENING
                        TCP    0.0.0.0:49669         0.0.0.0:0             LISTENING
                        TCP    127.0.0.1:53          0.0.0.0:0             LISTENING
                        TCP    192.168.1.100:53      0.0.0.0:0             LISTENING
                        TCP    192.168.1.100:139     0.0.0.0:0             LISTENING
                    </div>
                `;
            } else if (command.toLowerCase() === 'tasklist') {
                result = `
                    <div>
                        Nome da Imagem                  PID Utilização de Memória
                        ========================= ======== ================
                        System Idle Process              0          8 K
                        System                           4      1,320 K
                        Registry                       100      9,344 K
                        smss.exe                      1036      1,124 K
                        csrss.exe                     1180     16,876 K
                        wininit.exe                   1328      8,944 K
                        services.exe                  1380     15,828 K
                        lsass.exe                     1432     40,080 K
                        svchost.exe                   1648     30,964 K
                        svchost.exe                   1740     10,848 K
                        svchost.exe                   1908     31,812 K
                        svchost.exe                   1944     11,412 K
                        svchost.exe                   2032     36,836 K
                        dfsrs.exe                     2184     60,856 K
                        dns.exe                       2296     47,056 K
                        ismserv.exe                   2440      5,876 K
                        svchost.exe                   2544     15,356 K
                        spoolsv.exe                   2572     15,492 K
                        svchost.exe                   2632     15,784 K
                        w3wp.exe                      2704     33,364 K
                        svchost.exe                   2800     12,216 K
                        svchost.exe                   2920     13,304 K
                        vds.exe                       3048     13,776 K
                        svchost.exe                   3120     32,020 K
                        svchost.exe                   3164     25,376 K
                        inetinfo.exe                  3332     38,456 K
                        ${state.settings.antivirus ? 'wolfguard.exe                 3850     42,128 K' : ''}
                    </div>
                `;
            } else if (command.toLowerCase() === 'get-firewall') {
                result = `
                    <div>
                        Status do Firewall:  ${state.settings.firewall ? 'Ativado' : 'Desativado'}

                        Regras de Entrada: 184
                        Regras de Saída: 156
                        
                        Perfil de Domínio: Ativado
                        Perfil Privado: Ativado
                        Perfil Público: Ativado
                    </div>
                `;
            } else if (command.toLowerCase() === 'get-antivirus' || command.toLowerCase() === 'get-wolfguard') {
                result = `
                    <div>
                        WolfGuard Antivírus
                        Status:  ${state.settings.antivirus ? 'Ativado' : 'Desativado'}
                        Versão: 2025.1.1034
                        
                        Módulos:
                        - Proteção em Tempo Real: ${state.settings.wolfGuardFeatures.realTimeScan ? 'Ativado' : 'Desativado'}
                        - Proteção Web: ${state.settings.wolfGuardFeatures.webProtection ? 'Ativado' : 'Desativado'}
                        - Firewall: ${state.settings.wolfGuardFeatures.firewall ? 'Ativado' : 'Desativado'}
                        - Proteção contra Ransomware: ${state.settings.wolfGuardFeatures.ransomwareProtection ? 'Ativado' : 'Desativado'}
                        
                        Última verificação: 10/06/2025 08:50
                        Última atualização: 10/06/2025 08:30
                    </div>
                `;
            } else if (command.toLowerCase() === 'ssh') {
                result = `
                    <div>
                        Uso: ssh [-46AaCfGgKkMNnqsTtVvXxYy] [-B bind_interface]
                                [-b bind_address] [-c cipher_spec] [-D [bind_address:]port]
                                [-E log_file] [-e escape_char] [-F configfile] [-I pkcs11]
                                [-i identity_file] [-J [user@]host[:port]] [-L address]
                                [-l login_name] [-m mac_spec] [-O ctl_cmd] [-o option] [-p port]
                                [-Q query_option] [-R address] [-S ctl_path] [-W host:port]
                                [-w local_tun[:remote_tun]] destination [command]
                    </div>
                `;
            } else if (command.toLowerCase() === 'scp') {
                result = `
                    <div>
                        Uso: scp [-346BCpqrTv] [-c cipher] [-F ssh_config] [-i identity_file]
                                [-J destination] [-l limit] [-o ssh_option] [-P port]
                                [-S program] source ... target
                    </div>
                `;
            } else if (command.toLowerCase().startsWith('invoke-webrequest')) {
                result = `
                    <div>
                        StatusCode        : 200
                        StatusDescription : OK
                        Content           : <!DOCTYPE html>
                                            <html>
                                            <head>
                                                <title>Example Domain</title>
                                                ...
                                            </head>
                                            <body>
                                                <div>
                                                    <h1>Example Domain</h1>
                                                    <p>This domain is for use in illustrative examples in documents...</p>
                                                </div>
                                            </body>
                                            </html>

                        RawContent        : HTTP/1.1 200 OK
                                            Connection: keep-alive
                                            Content-Length: 648
                                            Server: nginx
                                            Content-Type: text/html; charset=UTF-8
                                            Cache-Control: max-age=604800
                                            ...

                        Forms             : {}
                        Headers           : {[Connection, keep-alive], [Content-Length, 648], [Server, nginx], [Content-Type, text/html; charset=UTF-8]...}
                        Images            : {}
                        InputFields       : {}
                        Links             : {@{outerHTML=<a href="https://www.iana.org/domains/example">More information...</a>; tagName=A; href=https://www.iana.org/domains/example}}
                        RawContentLength  : 648
                        RelationLink      : {}
                    </div>
                `;
            } else {
                result = `<div>O comando "${command}" não é reconhecido como nome de cmdlet, função, arquivo de script ou programa operável.</div>`;
            }
            
            return result;
        }
        
        // Funções para navegadores
        function browserNavigate(event, browserType) {
            if (event.key === 'Enter') {
                const addressInput = document.getElementById(`${browserType}-address`);
                const iframe = document.getElementById(`${browserType}-iframe`);
                
                let url = addressInput.value.trim();
                
                // Adicionar https:// se não estiver presente
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                
                // Atualizar URL na barra de endereço
                addressInput.value = url;
                
                // Navegar para a URL
                iframe.src = url;
            }
        }
        
        function browserBack(browserType) {
            const iframe = document.getElementById(`${browserType}-iframe`);
            iframe.contentWindow.history.back();
        }
        
        function browserForward(browserType) {
            const iframe = document.getElementById(`${browserType}-iframe`);
            iframe.contentWindow.history.forward();
        }
        
        function browserRefresh(browserType) {
            const iframe = document.getElementById(`${browserType}-iframe`);
            iframe.contentWindow.location.reload();
        }
        
        // Funções para WolfGuard Antivírus
        function toggleWolfGuardFeature(feature) {
            state.settings.wolfGuardFeatures[feature] = !state.settings.wolfGuardFeatures[feature];
            
            // Abrir a janela do WolfGuard novamente para atualizar o conteúdo
            if (state.windows['wolfguard']) {
                closeWindow('wolfguard');
                openApp('wolfguard');
            }
            
            // Salvar estado
            saveStateToLocalStorage();
        }
        
        function performScan() {
            showNotification('Iniciando verificação do sistema. Isso pode levar alguns minutos.');
            
            // Simular tempo de verificação
            setTimeout(() => {
                showNotification('Verificação concluída. Nenhuma ameaça encontrada.');
            }, 3000);
        }
        
        function updateWolfGuard() {
            showNotification('Verificando atualizações do WolfGuard...');
            
            // Simular tempo de atualização
            setTimeout(() => {
                showNotification('WolfGuard atualizado para a versão mais recente.');
            }, 2000);
        }
        
        // Funções para Windows Defender
        function runQuickScan() {
            showNotification('Iniciando verificação rápida. Isso pode levar alguns minutos.');
            
            // Simular tempo de verificação
            setTimeout(() => {
                showNotification('Verificação rápida concluída. Nenhuma ameaça encontrada.');
            }, 2500);
        }
        
        function runFullScan() {
            showNotification('Iniciando verificação completa. Isso pode levar várias horas.');
            
            // Simular tempo de verificação
            setTimeout(() => {
                showNotification('Verificação completa 5% concluída...');
                
                setTimeout(() => {
                    showNotification('Verificação completa interrompida para demonstração.');
                }, 3000);
            }, 2000);
        }
        
        function runCustomScan() {
            showNotification('Selecione os itens para verificação personalizada.');
            
            // Implementação simplificada
            setTimeout(() => {
                showNotification('Funcionalidade de verificação personalizada em desenvolvimento.');
            }, 1500);
        }
        
        function updateDefinitions() {
            showNotification('Verificando atualizações de definições de vírus...');
            
            // Simular tempo de atualização
            setTimeout(() => {
                showNotification('Definições de vírus atualizadas para a versão mais recente.');
            }, 2000);
        }
        
        // Funções para o Firewall
        function showFirewallRules() {
            showNotification('Abrindo regras do Firewall...');
        }
        
        function showFirewallLogs() {
            showNotification('Abrindo logs do Firewall...');
        }
        
        function showFirewallAdvanced() {
            showNotification('Abrindo configurações avançadas do Firewall...');
        }
        
        function restoreFirewallDefaults() {
            const confirmReset = confirm('Tem certeza que deseja restaurar as configurações padrão do Firewall?');
            if (confirmReset) {
                state.settings.firewall = true;
                showNotification('Configurações do Firewall restauradas para os padrões.');
                
                // Reabrir a janela para atualizar o conteúdo
                if (state.windows['firewall']) {
                    closeWindow('firewall');
                    openApp('firewall');
                }
                
                // Salvar estado
                saveStateToLocalStorage();
            }
        }
        
        // Funções para Remote Desktop
        function connectToRemoteDesktop() {
            const computer = document.getElementById('remote-computer').value;
            const username = document.getElementById('remote-username').value;
            
            if (computer && username) {
                showNotification(`Conectando a ${computer} como ${username}...`);
                
                // Simulação de conexão
                setTimeout(() => {
                    showNotification('Conexão estabelecida com sucesso.');
                }, 2000);
            } else {
                showNotification('Por favor, preencha o nome do computador e o nome de usuário.');
            }
        }
        
        function setRemoteComputer(computer) {
            document.getElementById('remote-computer').value = computer;
            document.getElementById('remote-username').value = 'Administrator';
            showNotification(`Computador selecionado: ${computer}`);
        }
        
        // Funções para configurações
        function switchSettingsCategory(category) {
            // Remover a classe 'active' de todas as categorias
            document.querySelectorAll('.settings-category').forEach(item => {
                item.classList.remove('active');
            });
            
            // Adicionar a classe 'active' à categoria selecionada
            document.querySelector(`.settings-category[onclick="switchSettingsCategory('${category}')"]`).classList.add('active');
            
            // Esconder todos os painéis de configurações
            document.querySelectorAll('.settings-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Mostrar o painel selecionado
            document.getElementById(`${category}-settings`).classList.add('active');
        }
        
        function toggleSetting(element) {
            element.classList.toggle('active');
        }
        
        function toggleFirewall() {
            state.settings.firewall = !state.settings.firewall;
            
            // Atualizar interface
            document.querySelectorAll('.settings-toggle').forEach(toggle => {
                if (toggle.parentElement.querySelector('.settings-option-title').textContent.includes('Firewall')) {
                    toggle.classList.toggle('active', state.settings.firewall);
                }
            });
            
            // Mostrar notificação
            showNotification(`Firewall de Rede do Windows ${state.settings.firewall ? 'ativado' : 'desativado'}.`);
            
            // Atualizar interface do Firewall se estiver aberto
            if (state.windows['firewall']) {
                closeWindow('firewall');
                openApp('firewall');
            }
            
            // Salvar estado
            saveStateToLocalStorage();
        }
        
        function toggleAntivirus() {
            state.settings.antivirus = !state.settings.antivirus;
            
            // Atualizar interface
            document.querySelectorAll('.settings-toggle').forEach(toggle => {
                if (toggle.parentElement.querySelector('.settings-option-title').textContent.includes('Proteção em Tempo Real')) {
                    toggle.classList.toggle('active', state.settings.antivirus);
                }
            });
            
            // Mostrar notificação
            showNotification(`Proteção contra Vírus e Ameaças ${state.settings.antivirus ? 'ativada' : 'desativada'}.`);
            
            // Atualizar interface do Windows Defender se estiver aberto
            if (state.windows['windows-defender']) {
                closeWindow('windows-defender');
                openApp('windows-defender');
            }
            
            // Salvar estado
            saveStateToLocalStorage();
        }
        
        function toggleAutoUpdate() {
            state.settings.autoUpdate = !state.settings.autoUpdate;
            
            // Atualizar interface
            document.querySelectorAll('.settings-toggle').forEach(toggle => {
                if (toggle.parentElement.querySelector('.settings-option-title').textContent.includes('Atualizações Automáticas')) {
                    toggle.classList.toggle('active', state.settings.autoUpdate);
                }
            });
            
            // Mostrar notificação
            showNotification(`Atualizações Automáticas ${state.settings.autoUpdate ? 'ativadas' : 'desativadas'}.`);
            
            // Salvar estado
            saveStateToLocalStorage();
        }
        
        function applyWallpaperFromSettings(wallpaperNumber) {
            // Remover a classe 'active' de todas as opções de papel de parede
            document.querySelectorAll('.wallpaper-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // Adicionar a classe 'active' à opção selecionada
            document.querySelector(`.wallpaper-option[onclick="applyWallpaperFromSettings(${wallpaperNumber})"]`).classList.add('active');
            
            // Aplicar papel de parede
            applyWallpaper(wallpaperNumber);
            
            // Mostrar notificação
            showNotification('Papel de parede aplicado com sucesso.');
        }
        
        function updateAccentColor(color) {
            document.documentElement.style.setProperty('--accent-color', color);
            state.settings.accentColor = color;
            
            // Salvar estado
            saveStateToLocalStorage();
            
            // Mostrar notificação
            showNotification('Cor de destaque atualizada.');
        }
        
        // Funções para alternar tabs nos aplicativos
        function switchServerManagerPanel(panelId) {
            // Esconder todos os painéis
            document.getElementById('dashboard-panel').style.display = 'none';
            document.getElementById('local-server-panel').style.display = 'none';
            document.getElementById('all-servers-panel').style.display = 'none';
            
            // Desativar todos os itens do menu
            const sidebarItems = document.querySelectorAll('.server-manager .sidebar-item');
            sidebarItems.forEach(item => item.classList.remove('active'));
            
            // Ativar painel selecionado
            document.getElementById(`${panelId}-panel`).style.display = 'grid';
            
            // Ativar item do menu
            const selectedItem = document.querySelector(`.server-manager .sidebar-item[onclick="switchServerManagerPanel('${panelId}')"]`);
            if (selectedItem) {
                selectedItem.classList.add('active');
            }
        }
        
        function switchAdminCenterTab(tabId) {
            // Esconder todos os conteúdos de tab
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            
            // Desativar todas as tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            
            // Ativar tab selecionada
            document.getElementById(`${tabId}-tab`).classList.add('active');
            
            // Ativar botão da tab
            const selectedTab = document.querySelector(`.tab[onclick="switchAdminCenterTab('${tabId}')"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
        }
        
        function switchGPOTab(tabId) {
            // Esconder todos os conteúdos de tab
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            
            // Desativar todas as tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            
            // Ativar tab selecionada
            document.getElementById(`${tabId}-tab`).classList.add('active');
            
            // Ativar botão da tab
            const selectedTab = document.querySelector(`.tab[onclick="switchGPOTab('${tabId}')"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
        }
        
        function switchStorageTab(tabId) {
            // Esconder todos os conteúdos de tab
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            
            // Desativar todas as tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            
            // Ativar tab selecionada
            document.getElementById(`${tabId}-tab`).classList.add('active');
            
            // Ativar botão da tab
            const selectedTab = document.querySelector(`.tab[onclick="switchStorageTab('${tabId}')"]`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
        }
        
        // Funções para configuração de rede
        function toggleDHCP(enabled) {
            state.ipConfig.dhcpEnabled = enabled;
            
            // Atualizar elementos da interface
            const staticConfig = document.getElementById('static-ip-config');
            const manualDNS = document.getElementById('manual-dns-config');
            
            if (enabled) {
                staticConfig.style.opacity = '0.5';
                manualDNS.style.opacity = '0.5';
                
                // Desabilitar campos
                document.getElementById('ip-address').disabled = true;
                document.getElementById('subnet-mask').disabled = true;
                document.getElementById('default-gateway').disabled = true;
                document.getElementById('preferred-dns').disabled = true;
                document.getElementById('alternate-dns').disabled = true;
                
                // Selecionar opção de DNS automático
                document.getElementById('dns-auto').checked = true;
            } else {
                staticConfig.style.opacity = '1';
                manualDNS.style.opacity = '1';
                
                // Habilitar campos
                document.getElementById('ip-address').disabled = false;
                document.getElementById('subnet-mask').disabled = false;
                document.getElementById('default-gateway').disabled = false;
                document.getElementById('preferred-dns').disabled = false;
                document.getElementById('alternate-dns').disabled = false;
                
                // Selecionar opção de DNS manual
                document.getElementById('dns-manual').checked = true;
            }
            
            // Salvar estado
            saveStateToLocalStorage();
        }
        
        function toggleDNS(automatic) {
            if (automatic) {
                document.getElementById('manual-dns-config').style.opacity = '0.5';
                document.getElementById('preferred-dns').disabled = true;
                document.getElementById('alternate-dns').disabled = true;
            } else {
                document.getElementById('manual-dns-config').style.opacity = '1';
                document.getElementById('preferred-dns').disabled = false;
                document.getElementById('alternate-dns').disabled = false;
            }
        }
        
        function saveNetworkConfig() {
            // Salvar configurações
            if (!state.ipConfig.dhcpEnabled) {
                state.ipConfig.ipAddress = document.getElementById('ip-address').value;
                state.ipConfig.subnetMask = document.getElementById('subnet-mask').value;
                state.ipConfig.gateway = document.getElementById('default-gateway').value;
                state.ipConfig.dns1 = document.getElementById('preferred-dns').value;
                state.ipConfig.dns2 = document.getElementById('alternate-dns').value;
            }
            
            // Salvar estado
            saveStateToLocalStorage();
            
            // Mostrar notificação
            showNotification('Configurações de rede salvas com sucesso');
        }
        
        function cancelNetworkConfig() {
            // Restaurar valores originais
            document.getElementById('ip-address').value = state.ipConfig.ipAddress;
            document.getElementById('subnet-mask').value = state.ipConfig.subnetMask;
            document.getElementById('default-gateway').value = state.ipConfig.gateway;
            document.getElementById('preferred-dns').value = state.ipConfig.dns1;
            document.getElementById('alternate-dns').value = state.ipConfig.dns2;
            
            // Restaurar modo DHCP
            if (state.ipConfig.dhcpEnabled) {
                document.getElementById('dhcp-radio').checked = true;
            } else {
                document.getElementById('static-radio').checked = true;
            }
            
            toggleDHCP(state.ipConfig.dhcpEnabled);
        }
        
        // Inicializar simulador
        document.addEventListener('DOMContentLoaded', function() {
            // Atualizar relógio
            updateClock();
            
            // Verificar se a imagem de fundo existe
            const desktop = document.getElementById('desktop');
            const img = new Image();
            img.onload = function() {
                // A imagem existe, não precisa fazer nada
            };
            img.onerror = function() {
                // A imagem não existe, usar fundo padrão
                desktop.style.backgroundImage = 'none';
                desktop.style.backgroundColor = '#0078d7';
            };
            img.src = 'd.jpg';
            
            // Carregar estado do localStorage
            loadStateFromLocalStorage();
            
            // Inicializar calendário
            updateCalendar();
        });
        
        // Documento clicado para limpar menus de contexto
        document.addEventListener('mousedown', function(e) {
            // Verificar se o clique foi no desktop
            if (e.target.id === 'desktop') {
                // Limpar seleção dos ícones
                document.querySelectorAll('.desktop-icon.selected').forEach(icon => {
                    icon.classList.remove('selected');
                });
                state.selectedItem = null;
            }
            
            // Fechar flyouts ao clicar fora deles
            if (!e.target.closest('#network-flyout') && !e.target.closest('#network-icon')) {
                document.getElementById('network-flyout').style.display = 'none';
            }
            
            if (!e.target.closest('#volume-flyout') && !e.target.closest('#sound-icon')) {
                document.getElementById('volume-flyout').style.display = 'none';
            }
            
            if (!e.target.closest('#calendar-flyout') && !e.target.closest('#clock-container')) {
                document.getElementById('calendar-flyout').style.display = 'none';
            }
            
            if (!e.target.closest('#action-center') && !e.target.closest('#action-center-icon')) {
                document.getElementById('action-center').style.display = 'none';
            }
        });
    </script>
</body>
</html>
